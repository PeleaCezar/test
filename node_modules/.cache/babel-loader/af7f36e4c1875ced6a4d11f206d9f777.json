{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { isNullOrUndefined, addClass, createElement, append, EventHandler, extend, remove } from '@syncfusion/ej2-base';\nimport { ListBase } from '@syncfusion/ej2-lists';\nimport { ViewBase } from '../renderer/view-base';\nimport * as util from '../base/util';\nimport * as cls from '../base/css-constant';\nimport * as event from '../base/constant';\n\nvar AgendaBase =\n/** @class */\nfunction (_super) {\n  __extends(AgendaBase, _super);\n\n  function AgendaBase(parent) {\n    return _super.call(this, parent) || this;\n  } // eslint-disable-next-line max-len\n\n\n  AgendaBase.prototype.createAgendaContentElement = function (type, listData, aTd, groupOrder, groupIndex) {\n    var _this = this;\n\n    var listElement;\n    var fieldMapping = this.parent.eventFields;\n\n    if (type === 'noEvents') {\n      var noEvents = [{\n        'subject': this.parent.localeObj.getConstant('noEvents')\n      }];\n      listElement = ListBase.createList(this.parent.createElement, noEvents, {\n        moduleName: 'agenda',\n        listClass: this.parent.activeView.viewClass,\n        itemClass: this.parent.activeView.viewClass,\n        template: \"<div class=\\\"\" + cls.AGENDA_NO_EVENT_CLASS + \"\\\">\" + this.parent.localeObj.getConstant('noEvents') + \"</div>\"\n      });\n\n      if (listElement.querySelector('.e-agenda-item').children.length === 0) {\n        listElement.firstElementChild.appendChild(createElement('div', {\n          className: cls.AGENDA_NO_EVENT_CLASS,\n          innerHTML: this.parent.localeObj.getConstant('noEvents')\n        }));\n      }\n    } else {\n      listElement = ListBase.createList(this.parent.createElement, listData, {\n        moduleName: 'agenda',\n        listClass: this.parent.activeView.viewClass,\n        itemClass: this.parent.activeView.viewClass\n      });\n      var listElements = [].slice.call(listElement.children);\n      listElements.forEach(function (element, li) {\n        var appWrapper = createElement('div', {\n          className: cls.APPOINTMENT_CLASS,\n          attrs: {\n            'data-id': 'Appointment_' + listData[li][_this.parent.eventFields.id],\n            'data-guid': listData[li].Guid,\n            'role': 'button',\n            'tabindex': '0',\n            'aria-readonly': _this.parent.eventBase.getReadonlyAttribute(listData[li]),\n            'aria-selected': 'false',\n            'aria-grabbed': 'true',\n            'aria-label': _this.parent.getAnnouncementString(listData[li])\n          }\n        });\n\n        if (!isNullOrUndefined(groupIndex)) {\n          appWrapper.setAttribute('data-group-index', groupIndex.toString());\n        }\n\n        _this.parent.eventBase.applyResourceColor(appWrapper, listData[li], 'borderColor', groupOrder);\n\n        var templateEle;\n\n        if (!isNullOrUndefined(_this.parent.activeViewOptions.eventTemplate)) {\n          addClass([appWrapper], cls.EVENT_TEMPLATE);\n          var scheduleId = _this.parent.element.id + '_';\n          var viewName = _this.parent.activeViewOptions.eventTemplateName;\n          var templateId = scheduleId + viewName + 'eventTemplate';\n          templateEle = _this.parent.getAppointmentTemplate()(listData[li], _this.parent, 'eventTemplate', templateId, false);\n\n          if (!isNullOrUndefined(listData[li][fieldMapping.recurrenceRule])) {\n            var iconClass = listData[li][fieldMapping.id] === listData[li][fieldMapping.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appWrapper.appendChild(createElement('div', {\n              className: cls.ICON + ' ' + iconClass\n            }));\n          }\n        } else {\n          templateEle = _this.createAppointment(listData[li]);\n        }\n\n        append([].slice.call(templateEle), appWrapper);\n        util.removeChildren(element);\n        element.appendChild(appWrapper);\n        var args = {\n          data: extend({}, listData[li], null, true),\n          element: element,\n          cancel: false\n        };\n\n        _this.parent.trigger(event.eventRendered, args, function (eventArgs) {\n          if (eventArgs.cancel) {\n            remove(element);\n          }\n        });\n      });\n    }\n\n    aTd.appendChild(listElement);\n\n    if (this.parent.currentView === 'MonthAgenda' && this.parent.activeViewOptions.group.resources.length > 0 || this.parent.currentView === 'Agenda') {\n      addClass([aTd], cls.AGENDA_DAY_BORDER_CLASS);\n    }\n\n    this.parent.renderTemplates();\n    return aTd;\n  };\n\n  AgendaBase.prototype.createAppointment = function (event) {\n    var fieldMapping = this.parent.eventFields;\n    var eventSubject = event[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    var eventLocation = event[fieldMapping.location] || this.parent.eventSettings.fields.location.default;\n    var appSubjectWrap = createElement('div', {\n      className: cls.SUBJECT_WRAP\n    });\n\n    if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n      eventSubject += ',';\n    }\n\n    appSubjectWrap.appendChild(createElement('div', {\n      className: cls.SUBJECT_CLASS,\n      innerHTML: eventSubject\n    }));\n\n    if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n      appSubjectWrap.appendChild(createElement('div', {\n        className: cls.LOCATION_CLASS,\n        innerHTML: eventLocation\n      }));\n    }\n\n    if (!isNullOrUndefined(event[fieldMapping.recurrenceRule])) {\n      var iconClass = event[fieldMapping.id] === event[fieldMapping.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      appSubjectWrap.appendChild(createElement('div', {\n        className: cls.ICON + ' ' + iconClass\n      }));\n    }\n\n    var strDate = event[fieldMapping.startTime];\n    var endDate = event[fieldMapping.endTime];\n    var isAllDay = event[fieldMapping.isAllDay];\n    var allDayStr = this.parent.localeObj.getConstant('allDay');\n    var timeStr = this.parent.getTimeString(strDate) + ' - ' + this.parent.getTimeString(endDate);\n\n    if (!isNullOrUndefined(event.data)) {\n      var milliSeconds = endDate.getTimezoneOffset() !== strDate.getTimezoneOffset() ? endDate.getTime() - strDate.getTime() + 3600000 : endDate.getTime() - strDate.getTime();\n      var eventString = milliSeconds / util.MS_PER_DAY >= 1 ? allDayStr : timeStr;\n      allDayStr = eventString + ' (' + this.parent.localeObj.getConstant('day') + ' ' + event.data.index + '/' + event.data.count + ')';\n    }\n\n    var displayStr = !isNullOrUndefined(event.data) || isAllDay ? allDayStr : timeStr;\n    var appDateTime = createElement('div', {\n      className: cls.DATE_TIME_CLASS,\n      innerHTML: displayStr\n    });\n    return [appSubjectWrap, appDateTime];\n  };\n\n  AgendaBase.prototype.processAgendaEvents = function (events) {\n    var eventsProcessed = [];\n\n    if (isNullOrUndefined(events)) {\n      return eventsProcessed;\n    }\n\n    for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\n      var event_1 = events_1[_i];\n      var spanned = this.parent.eventBase.splitEventByDay(event_1);\n      eventsProcessed = eventsProcessed.concat(spanned.length > 1 ? spanned : event_1);\n    }\n\n    return eventsProcessed;\n  };\n\n  AgendaBase.prototype.wireEventActions = function () {\n    var eventElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n\n    for (var _i = 0, eventElement_1 = eventElement; _i < eventElement_1.length; _i++) {\n      var element = eventElement_1[_i];\n      this.parent.eventBase.wireAppointmentEvents(element, this.parent.getEventDetails(element), true);\n    }\n\n    var dateHeaderElement = [].slice.call(this.parent.element.querySelectorAll('.e-m-date'));\n\n    for (var _a = 0, dateHeaderElement_1 = dateHeaderElement; _a < dateHeaderElement_1.length; _a++) {\n      var element = dateHeaderElement_1[_a];\n      EventHandler.add(element, 'click', this.parent.agendaModule.dayNavigationClick, this);\n    }\n  };\n\n  AgendaBase.prototype.calculateResourceTableElement = function (tBody, noOfDays, agendaDate) {\n    if (isNullOrUndefined(this.parent.resourceBase.lastResourceLevel)) {\n      var level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n      this.parent.resourceBase.generateResourceLevels(level);\n    }\n\n    var agendaLastDate = util.addDays(new Date(agendaDate.getTime()), noOfDays);\n    var days = this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda' ? noOfDays : 1;\n    var resColl = this.parent.resourceBase.resourceCollection;\n    var resData = this.parent.resourceBase.lastResourceLevel;\n    var initialDate = agendaDate;\n\n    for (var i = 0; i < days; i++) {\n      var lastLevelInfo = [];\n      var tempLastLevelInfo = [];\n      var tempIndex = 0;\n      var eventObj = void 0;\n      var dateObj = void 0;\n      var firstDate = util.addDays(initialDate, i);\n      var finalDate = this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda' ? util.addDays(firstDate, 1) : agendaLastDate;\n      var agendaCollection = this.parent.eventBase.filterEvents(firstDate, finalDate);\n\n      if (agendaCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n        for (var res = 0; res < resData.length; res++) {\n          noOfDays = !this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda' ? noOfDays : 1;\n          var data = [];\n          agendaDate = firstDate; // eslint-disable-next-line max-len\n\n          var resDataCollection = this.parent.eventBase.filterEvents(agendaDate, agendaLastDate, agendaCollection, resData[res]);\n\n          if (resDataCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n            for (var r = 0; r < noOfDays; r++) {\n              // eslint-disable-next-line max-len\n              var resDayCollection = this.parent.eventBase.filterEvents(agendaDate, util.addDays(agendaDate, 1), resDataCollection, undefined);\n\n              if (resDayCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n                data.push(resDayCollection[0]);\n                eventObj = {\n                  rowSpan: 1,\n                  type: 'eventColumn',\n                  resource: resColl[resColl.length - 1],\n                  groupIndex: resData[res].groupIndex,\n                  groupOrder: resData[res].groupOrder,\n                  resourceData: resData[res].resourceData,\n                  eventData: resDayCollection,\n                  date: agendaDate\n                };\n                dateObj = {\n                  rowSpan: 1,\n                  type: 'dateColumn',\n                  resource: resColl[resColl.length - 1],\n                  groupOrder: resData[res].groupOrder,\n                  resourceData: resData[res].resourceData,\n                  date: agendaDate\n                };\n\n                if (!lastLevelInfo[tempIndex]) {\n                  lastLevelInfo[tempIndex] = [];\n                }\n\n                lastLevelInfo[tempIndex].push(eventObj);\n                lastLevelInfo[tempIndex].push(dateObj);\n                tempIndex++;\n              }\n\n              agendaDate = util.addDays(agendaDate, 1);\n\n              if (agendaDate.getTime() >= agendaLastDate.getTime() || this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n                lastLevelInfo[lastLevelInfo.length - 1][1].cssClass = cls.AGENDA_DAY_BORDER_CLASS;\n                var tempObj = {\n                  rowSpan: data.length,\n                  type: 'resourceColumn',\n                  resource: resColl[resColl.length - 1],\n                  groupOrder: resData[res].groupOrder.slice(0, -1),\n                  resourceData: resData[res].resourceData,\n                  groupIndex: lastLevelInfo.length - data.length,\n                  className: [cls.RESOURCE_NAME],\n                  date: agendaDate\n                };\n                lastLevelInfo[lastLevelInfo.length - data.length].push(tempObj);\n                tempLastLevelInfo.push(extend({}, tempObj, null, true));\n                break;\n              }\n            }\n          }\n        }\n\n        var topResources = resColl.slice(0, -1);\n        var tempGroupedData = [];\n        var totalRowSpan = 0;\n\n        for (var y = 0; y < topResources.length; y++) {\n          var data = topResources[topResources.length - (y + 1)].dataSource;\n\n          for (var x = 0; x < data.length; x++) {\n            var z = 0;\n\n            for (var u = 0; u < tempLastLevelInfo.length; u++) {\n              // eslint-disable-next-line max-len\n              if (tempLastLevelInfo[u].groupOrder[topResources.length - (y + 1)] === data[x][topResources[topResources.length - (y + 1)].idField]) {\n                totalRowSpan = totalRowSpan + tempLastLevelInfo[u].rowSpan;\n                tempGroupedData.push(extend({}, tempLastLevelInfo[u], null, true));\n              }\n\n              if (++z === tempLastLevelInfo.length && tempGroupedData.length > 0) {\n                tempGroupedData[0].rowSpan = totalRowSpan;\n                tempGroupedData[0].type = 'parentColumnLevel_' + (y + 1);\n                tempGroupedData[0].resource = topResources[topResources.length - (y + 1)];\n                tempGroupedData[0].resourceData = data[x];\n                tempGroupedData[0].date = agendaDate;\n                lastLevelInfo[tempGroupedData[0].groupIndex].push(tempGroupedData[0]);\n                tempGroupedData = [];\n                totalRowSpan = 0;\n              }\n            }\n          }\n        }\n\n        this.createResourceTableRow(lastLevelInfo, tBody);\n      }\n    }\n\n    var totalCollection = this.parent.eventBase.filterEvents(initialDate, agendaLastDate);\n\n    if (totalCollection.length === 0 && !this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n      this.renderEmptyContent(tBody, initialDate);\n    }\n  };\n\n  AgendaBase.prototype.createResourceTableRow = function (tContent, tBody) {\n    var tr = createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    var ntr;\n    var td = createElement('td', {\n      attrs: {\n        role: 'gridcell',\n        'aria-selected': 'false'\n      }\n    });\n    var tempData;\n    var rowSpan = 0;\n    var level;\n\n    if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n      var tContentCollection = [];\n      var parentCollection = this.parent.resourceBase.resourceCollection.slice(0, -1);\n\n      for (var w = 0; w < tContent.length; w++) {\n        tContentCollection = tContentCollection.concat(tContent[w]);\n      }\n\n      level = parentCollection.length > 0 ? 'parentColumnLevel_' + parentCollection.length : 'resourceColumn';\n      var rowSpanCollection = tContentCollection.filter(function (data) {\n        return data.type === level;\n      });\n\n      for (var x = 0; x < rowSpanCollection.length; x++) {\n        rowSpan = rowSpan + rowSpanCollection[x].rowSpan;\n      }\n    }\n\n    for (var row = 0; row < tContent.length; row++) {\n      ntr = tr.cloneNode();\n\n      for (var col = tContent[row].length - 1; col >= 0; col--) {\n        var data = tContent[row][col];\n        var ntd = td.cloneNode();\n\n        if (data.type === 'dateColumn') {\n          if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n            tempData = tContent[row][col];\n            continue;\n          }\n\n          ntd.setAttribute('data-date', data.date.getTime().toString());\n          ntd.appendChild(this.createDateHeaderElement(data.date));\n          var className = [cls.AGENDA_CELLS_CLASS, cls.AGENDA_DATE_CLASS];\n\n          if (data.cssClass) {\n            className.push(data.cssClass);\n          }\n\n          addClass([ntd], className);\n          ntr.appendChild(ntd);\n        } else if (data.type === 'eventColumn') {\n          var elementType = data.eventData.length === 0 ? 'noEvents' : 'data';\n          ntd = this.createAgendaContentElement(elementType, data.eventData, ntd, data.groupOrder, data.groupIndex);\n          ntd.setAttribute('data-date', data.date.getTime().toString());\n\n          if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n            addClass([ntd], [cls.AGENDA_CELLS_CLASS, cls.AGENDA_DAY_PADDING_CLASS]);\n          }\n\n          ntr.appendChild(ntd);\n        } else {\n          ntd.setAttribute('rowspan', data.rowSpan.toString());\n          addClass([ntd], cls.AGENDA_RESOURCE_CLASS);\n          this.setResourceHeaderContent(ntd, data, data.className[0]);\n          ntr.appendChild(ntd);\n        }\n      }\n\n      if (this.parent.activeViewOptions.group.byDate && row === 0 && this.parent.currentView !== 'MonthAgenda') {\n        var ntd = td.cloneNode();\n        ntd.setAttribute('data-date', tempData.date.getTime().toString());\n        ntd.setAttribute('rowspan', rowSpan.toString());\n        ntd.appendChild(this.createDateHeaderElement(tempData.date));\n        addClass([ntd], [cls.AGENDA_CELLS_CLASS, cls.AGENDA_DATE_CLASS, cls.DATE_BORDER_CLASS]);\n        var daysCount = util.getDaysCount(this.parent.selectedDate.getTime(), tempData.date.getTime());\n        ntr.setAttribute('aria-rowindex', daysCount.toString());\n\n        if (this.parent.element.querySelector(\".e-agenda-view tr[aria-rowindex=\\\"\" + daysCount + \"\\\"]\")) {\n          break;\n        }\n\n        ntr.insertBefore(ntd, ntr.childNodes[0]);\n      }\n\n      tBody.appendChild(ntr);\n    }\n  };\n\n  AgendaBase.prototype.createDateHeaderElement = function (date) {\n    var dateHeader;\n\n    if (this.parent.activeViewOptions.dateHeaderTemplate) {\n      dateHeader = createElement('div', {\n        className: cls.AGENDA_HEADER_CLASS\n      });\n      var args = {\n        date: date,\n        type: 'dateHeader'\n      };\n      var scheduleId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n      var templateId = scheduleId + viewName + 'dateHeaderTemplate';\n      var dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(args, this.parent, 'dateHeaderTemplate', templateId, false));\n      append(dateTemplate, dateHeader);\n    } else {\n      dateHeader = this.getMobileDateElement(date, cls.AGENDA_HEADER_CLASS);\n    }\n\n    return dateHeader;\n  };\n\n  AgendaBase.prototype.renderEmptyContent = function (tBody, agendaDate) {\n    var eTr = this.createTableRowElement(agendaDate, 'noEvents');\n    var eTd = eTr.children[0];\n    var noEvents = createElement('div', {\n      className: cls.AGENDA_EMPTY_EVENT_CLASS,\n      innerHTML: this.parent.localeObj.getConstant('noEvents')\n    });\n    eTd.appendChild(noEvents);\n    tBody.appendChild(eTr);\n  };\n\n  AgendaBase.prototype.createTableRowElement = function (date, type) {\n    var daysCount = util.getDaysCount(this.parent.selectedDate.getTime(), date.getTime());\n    var tr = createElement('tr', {\n      attrs: {\n        'role': 'row',\n        'aria-rowindex': daysCount.toString()\n      }\n    });\n    var td = createElement('td', {\n      attrs: {\n        'class': type === 'monthHeader' ? cls.MONTH_HEADER_CLASS : cls.AGENDA_CELLS_CLASS,\n        'role': 'gridcell',\n        'aria-selected': 'false',\n        'aria-colindex': daysCount.toString(),\n        'data-date': date.getTime().toString()\n      }\n    });\n    var dTd = td.cloneNode();\n    var aTd = td.cloneNode();\n    tr.appendChild(dTd);\n\n    if (type !== 'noEvents') {\n      tr.appendChild(aTd);\n    }\n\n    return tr;\n  };\n\n  AgendaBase.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n  };\n\n  return AgendaBase;\n}(ViewBase);\n\nexport { AgendaBase };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","isNullOrUndefined","addClass","createElement","append","EventHandler","extend","remove","ListBase","ViewBase","util","cls","event","AgendaBase","_super","parent","call","createAgendaContentElement","type","listData","aTd","groupOrder","groupIndex","_this","listElement","fieldMapping","eventFields","noEvents","localeObj","getConstant","createList","moduleName","listClass","activeView","viewClass","itemClass","template","AGENDA_NO_EVENT_CLASS","querySelector","children","length","firstElementChild","appendChild","className","innerHTML","listElements","slice","forEach","element","li","appWrapper","APPOINTMENT_CLASS","attrs","id","Guid","eventBase","getReadonlyAttribute","getAnnouncementString","setAttribute","toString","applyResourceColor","templateEle","activeViewOptions","eventTemplate","EVENT_TEMPLATE","scheduleId","viewName","eventTemplateName","templateId","getAppointmentTemplate","recurrenceRule","iconClass","recurrenceID","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","ICON","createAppointment","removeChildren","args","data","cancel","trigger","eventRendered","eventArgs","currentView","group","resources","AGENDA_DAY_BORDER_CLASS","renderTemplates","eventSubject","subject","eventSettings","fields","default","eventLocation","location","appSubjectWrap","SUBJECT_WRAP","SUBJECT_CLASS","LOCATION_CLASS","strDate","startTime","endDate","endTime","isAllDay","allDayStr","timeStr","getTimeString","milliSeconds","getTimezoneOffset","getTime","eventString","MS_PER_DAY","index","count","displayStr","appDateTime","DATE_TIME_CLASS","processAgendaEvents","events","eventsProcessed","_i","events_1","event_1","spanned","splitEventByDay","concat","wireEventActions","eventElement","querySelectorAll","eventElement_1","wireAppointmentEvents","getEventDetails","dateHeaderElement","_a","dateHeaderElement_1","add","agendaModule","dayNavigationClick","calculateResourceTableElement","tBody","noOfDays","agendaDate","resourceBase","lastResourceLevel","level","getDateSlots","renderDates","workDays","generateResourceLevels","agendaLastDate","addDays","Date","days","byDate","resColl","resourceCollection","resData","initialDate","i","lastLevelInfo","tempLastLevelInfo","tempIndex","eventObj","dateObj","firstDate","finalDate","agendaCollection","filterEvents","hideEmptyAgendaDays","res","resDataCollection","r","resDayCollection","undefined","push","rowSpan","resource","resourceData","eventData","date","cssClass","tempObj","RESOURCE_NAME","topResources","tempGroupedData","totalRowSpan","y","dataSource","x","z","u","idField","createResourceTableRow","totalCollection","allowVirtualScrolling","renderEmptyContent","tContent","tr","role","ntr","td","tempData","tContentCollection","parentCollection","w","rowSpanCollection","filter","row","cloneNode","col","ntd","createDateHeaderElement","AGENDA_CELLS_CLASS","AGENDA_DATE_CLASS","elementType","AGENDA_DAY_PADDING_CLASS","AGENDA_RESOURCE_CLASS","setResourceHeaderContent","DATE_BORDER_CLASS","daysCount","getDaysCount","selectedDate","insertBefore","childNodes","dateHeader","dateHeaderTemplate","AGENDA_HEADER_CLASS","dateHeaderTemplateName","dateTemplate","getDateHeaderTemplate","getMobileDateElement","eTr","createTableRowElement","eTd","AGENDA_EMPTY_EVENT_CLASS","MONTH_HEADER_CLASS","dTd","destroy"],"sources":["C:/Users/cpelea/OneDrive - ENDAVA/Desktop/test/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/agenda-base.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isNullOrUndefined, addClass, createElement, append, EventHandler, extend, remove } from '@syncfusion/ej2-base';\nimport { ListBase } from '@syncfusion/ej2-lists';\nimport { ViewBase } from '../renderer/view-base';\nimport * as util from '../base/util';\nimport * as cls from '../base/css-constant';\nimport * as event from '../base/constant';\nvar AgendaBase = /** @class */ (function (_super) {\n    __extends(AgendaBase, _super);\n    function AgendaBase(parent) {\n        return _super.call(this, parent) || this;\n    }\n    // eslint-disable-next-line max-len\n    AgendaBase.prototype.createAgendaContentElement = function (type, listData, aTd, groupOrder, groupIndex) {\n        var _this = this;\n        var listElement;\n        var fieldMapping = this.parent.eventFields;\n        if (type === 'noEvents') {\n            var noEvents = [{ 'subject': this.parent.localeObj.getConstant('noEvents') }];\n            listElement = ListBase.createList(this.parent.createElement, noEvents, {\n                moduleName: 'agenda',\n                listClass: this.parent.activeView.viewClass,\n                itemClass: this.parent.activeView.viewClass,\n                template: \"<div class=\\\"\" + cls.AGENDA_NO_EVENT_CLASS + \"\\\">\" + this.parent.localeObj.getConstant('noEvents') + \"</div>\"\n            });\n            if (listElement.querySelector('.e-agenda-item').children.length === 0) {\n                listElement.firstElementChild.appendChild(createElement('div', { className: cls.AGENDA_NO_EVENT_CLASS, innerHTML: this.parent.localeObj.getConstant('noEvents') }));\n            }\n        }\n        else {\n            listElement = ListBase.createList(this.parent.createElement, listData, {\n                moduleName: 'agenda',\n                listClass: this.parent.activeView.viewClass,\n                itemClass: this.parent.activeView.viewClass\n            });\n            var listElements = [].slice.call(listElement.children);\n            listElements.forEach(function (element, li) {\n                var appWrapper = createElement('div', {\n                    className: cls.APPOINTMENT_CLASS, attrs: {\n                        'data-id': 'Appointment_' + listData[li][_this.parent.eventFields.id],\n                        'data-guid': listData[li].Guid,\n                        'role': 'button',\n                        'tabindex': '0',\n                        'aria-readonly': _this.parent.eventBase.getReadonlyAttribute(listData[li]),\n                        'aria-selected': 'false',\n                        'aria-grabbed': 'true',\n                        'aria-label': _this.parent.getAnnouncementString(listData[li])\n                    }\n                });\n                if (!isNullOrUndefined(groupIndex)) {\n                    appWrapper.setAttribute('data-group-index', groupIndex.toString());\n                }\n                _this.parent.eventBase.applyResourceColor(appWrapper, listData[li], 'borderColor', groupOrder);\n                var templateEle;\n                if (!isNullOrUndefined(_this.parent.activeViewOptions.eventTemplate)) {\n                    addClass([appWrapper], cls.EVENT_TEMPLATE);\n                    var scheduleId = _this.parent.element.id + '_';\n                    var viewName = _this.parent.activeViewOptions.eventTemplateName;\n                    var templateId = scheduleId + viewName + 'eventTemplate';\n                    templateEle = _this.parent.getAppointmentTemplate()(listData[li], _this.parent, 'eventTemplate', templateId, false);\n                    if (!isNullOrUndefined(listData[li][fieldMapping.recurrenceRule])) {\n                        var iconClass = (listData[li][fieldMapping.id] === listData[li][fieldMapping.recurrenceID]) ?\n                            cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n                        appWrapper.appendChild(createElement('div', { className: cls.ICON + ' ' + iconClass }));\n                    }\n                }\n                else {\n                    templateEle = _this.createAppointment(listData[li]);\n                }\n                append([].slice.call(templateEle), appWrapper);\n                util.removeChildren(element);\n                element.appendChild(appWrapper);\n                var args = {\n                    data: extend({}, listData[li], null, true),\n                    element: element, cancel: false\n                };\n                _this.parent.trigger(event.eventRendered, args, function (eventArgs) {\n                    if (eventArgs.cancel) {\n                        remove(element);\n                    }\n                });\n            });\n        }\n        aTd.appendChild(listElement);\n        if ((this.parent.currentView === 'MonthAgenda' && this.parent.activeViewOptions.group.resources.length > 0)\n            || this.parent.currentView === 'Agenda') {\n            addClass([aTd], cls.AGENDA_DAY_BORDER_CLASS);\n        }\n        this.parent.renderTemplates();\n        return aTd;\n    };\n    AgendaBase.prototype.createAppointment = function (event) {\n        var fieldMapping = this.parent.eventFields;\n        var eventSubject = (event[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default\n            || this.parent.localeObj.getConstant('addTitle'));\n        var eventLocation = (event[fieldMapping.location] || this.parent.eventSettings.fields.location.default);\n        var appSubjectWrap = createElement('div', { className: cls.SUBJECT_WRAP });\n        if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n            eventSubject += ',';\n        }\n        appSubjectWrap.appendChild(createElement('div', { className: cls.SUBJECT_CLASS, innerHTML: eventSubject }));\n        if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n            appSubjectWrap.appendChild(createElement('div', { className: cls.LOCATION_CLASS, innerHTML: eventLocation }));\n        }\n        if (!isNullOrUndefined(event[fieldMapping.recurrenceRule])) {\n            var iconClass = (event[fieldMapping.id] === event[fieldMapping.recurrenceID]) ?\n                cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appSubjectWrap.appendChild(createElement('div', { className: cls.ICON + ' ' + iconClass }));\n        }\n        var strDate = event[fieldMapping.startTime];\n        var endDate = event[fieldMapping.endTime];\n        var isAllDay = event[fieldMapping.isAllDay];\n        var allDayStr = this.parent.localeObj.getConstant('allDay');\n        var timeStr = this.parent.getTimeString(strDate) + ' - ' + this.parent.getTimeString(endDate);\n        if (!isNullOrUndefined(event.data)) {\n            var milliSeconds = (endDate.getTimezoneOffset() !== strDate.getTimezoneOffset()) ?\n                (endDate.getTime() - strDate.getTime() + 3600000) : (endDate.getTime() - strDate.getTime());\n            var eventString = (milliSeconds / util.MS_PER_DAY) >= 1 ? allDayStr : timeStr;\n            allDayStr = eventString + ' (' + this.parent.localeObj.getConstant('day') + ' '\n                + event.data.index + '/' + event.data.count + ')';\n        }\n        var displayStr = (!isNullOrUndefined(event.data) || isAllDay) ? allDayStr : timeStr;\n        var appDateTime = createElement('div', { className: cls.DATE_TIME_CLASS, innerHTML: displayStr });\n        return [appSubjectWrap, appDateTime];\n    };\n    AgendaBase.prototype.processAgendaEvents = function (events) {\n        var eventsProcessed = [];\n        if (isNullOrUndefined(events)) {\n            return eventsProcessed;\n        }\n        for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\n            var event_1 = events_1[_i];\n            var spanned = this.parent.eventBase.splitEventByDay(event_1);\n            eventsProcessed = eventsProcessed.concat(spanned.length > 1 ? spanned : event_1);\n        }\n        return eventsProcessed;\n    };\n    AgendaBase.prototype.wireEventActions = function () {\n        var eventElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CLASS));\n        for (var _i = 0, eventElement_1 = eventElement; _i < eventElement_1.length; _i++) {\n            var element = eventElement_1[_i];\n            this.parent.eventBase.wireAppointmentEvents(element, this.parent.getEventDetails(element), true);\n        }\n        var dateHeaderElement = [].slice.call(this.parent.element.querySelectorAll('.e-m-date'));\n        for (var _a = 0, dateHeaderElement_1 = dateHeaderElement; _a < dateHeaderElement_1.length; _a++) {\n            var element = dateHeaderElement_1[_a];\n            EventHandler.add(element, 'click', this.parent.agendaModule.dayNavigationClick, this);\n        }\n    };\n    AgendaBase.prototype.calculateResourceTableElement = function (tBody, noOfDays, agendaDate) {\n        if (isNullOrUndefined(this.parent.resourceBase.lastResourceLevel)) {\n            var level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n            this.parent.resourceBase.generateResourceLevels(level);\n        }\n        var agendaLastDate = util.addDays(new Date(agendaDate.getTime()), noOfDays);\n        var days = (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') ? noOfDays : 1;\n        var resColl = this.parent.resourceBase.resourceCollection;\n        var resData = this.parent.resourceBase.lastResourceLevel;\n        var initialDate = agendaDate;\n        for (var i = 0; i < days; i++) {\n            var lastLevelInfo = [];\n            var tempLastLevelInfo = [];\n            var tempIndex = 0;\n            var eventObj = void 0;\n            var dateObj = void 0;\n            var firstDate = util.addDays(initialDate, i);\n            var finalDate = (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda')\n                ? util.addDays(firstDate, 1) : agendaLastDate;\n            var agendaCollection = this.parent.eventBase.filterEvents(firstDate, finalDate);\n            if (agendaCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n                for (var res = 0; res < resData.length; res++) {\n                    noOfDays = (!this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') ? noOfDays : 1;\n                    var data = [];\n                    agendaDate = firstDate;\n                    // eslint-disable-next-line max-len\n                    var resDataCollection = this.parent.eventBase.filterEvents(agendaDate, agendaLastDate, agendaCollection, resData[res]);\n                    if (resDataCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n                        for (var r = 0; r < noOfDays; r++) {\n                            // eslint-disable-next-line max-len\n                            var resDayCollection = this.parent.eventBase.filterEvents(agendaDate, util.addDays(agendaDate, 1), resDataCollection, undefined);\n                            if (resDayCollection.length > 0 || !this.parent.hideEmptyAgendaDays ||\n                                this.parent.currentView === 'MonthAgenda') {\n                                data.push(resDayCollection[0]);\n                                eventObj = {\n                                    rowSpan: 1, type: 'eventColumn', resource: resColl[resColl.length - 1],\n                                    groupIndex: resData[res].groupIndex, groupOrder: resData[res].groupOrder,\n                                    resourceData: resData[res].resourceData, eventData: resDayCollection, date: agendaDate\n                                };\n                                dateObj = {\n                                    rowSpan: 1, type: 'dateColumn', resource: resColl[resColl.length - 1],\n                                    groupOrder: resData[res].groupOrder, resourceData: resData[res].resourceData,\n                                    date: agendaDate\n                                };\n                                if (!lastLevelInfo[tempIndex]) {\n                                    lastLevelInfo[tempIndex] = [];\n                                }\n                                lastLevelInfo[tempIndex].push(eventObj);\n                                lastLevelInfo[tempIndex].push(dateObj);\n                                tempIndex++;\n                            }\n                            agendaDate = util.addDays(agendaDate, 1);\n                            if (agendaDate.getTime() >= agendaLastDate.getTime() || this.parent.activeViewOptions.group.byDate\n                                || this.parent.currentView === 'MonthAgenda') {\n                                lastLevelInfo[lastLevelInfo.length - 1][1].cssClass = cls.AGENDA_DAY_BORDER_CLASS;\n                                var tempObj = {\n                                    rowSpan: data.length, type: 'resourceColumn', resource: resColl[resColl.length - 1],\n                                    groupOrder: resData[res].groupOrder.slice(0, -1), resourceData: resData[res].resourceData,\n                                    groupIndex: (lastLevelInfo.length - data.length), className: [cls.RESOURCE_NAME],\n                                    date: agendaDate\n                                };\n                                lastLevelInfo[lastLevelInfo.length - data.length].push(tempObj);\n                                tempLastLevelInfo.push(extend({}, tempObj, null, true));\n                                break;\n                            }\n                        }\n                    }\n                }\n                var topResources = resColl.slice(0, -1);\n                var tempGroupedData = [];\n                var totalRowSpan = 0;\n                for (var y = 0; y < topResources.length; y++) {\n                    var data = topResources[topResources.length - (y + 1)].dataSource;\n                    for (var x = 0; x < data.length; x++) {\n                        var z = 0;\n                        for (var u = 0; u < tempLastLevelInfo.length; u++) {\n                            // eslint-disable-next-line max-len\n                            if (tempLastLevelInfo[u].groupOrder[topResources.length - (y + 1)] === data[x][topResources[topResources.length - (y + 1)].idField]) {\n                                totalRowSpan = totalRowSpan + tempLastLevelInfo[u].rowSpan;\n                                tempGroupedData.push(extend({}, tempLastLevelInfo[u], null, true));\n                            }\n                            if (++z === tempLastLevelInfo.length && tempGroupedData.length > 0) {\n                                tempGroupedData[0].rowSpan = totalRowSpan;\n                                tempGroupedData[0].type = 'parentColumnLevel_' + (y + 1);\n                                tempGroupedData[0].resource = topResources[topResources.length - (y + 1)];\n                                tempGroupedData[0].resourceData = data[x];\n                                tempGroupedData[0].date = agendaDate;\n                                lastLevelInfo[tempGroupedData[0].groupIndex].push(tempGroupedData[0]);\n                                tempGroupedData = [];\n                                totalRowSpan = 0;\n                            }\n                        }\n                    }\n                }\n                this.createResourceTableRow(lastLevelInfo, tBody);\n            }\n        }\n        var totalCollection = this.parent.eventBase.filterEvents(initialDate, agendaLastDate);\n        if (totalCollection.length === 0 && !this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n            this.renderEmptyContent(tBody, initialDate);\n        }\n    };\n    AgendaBase.prototype.createResourceTableRow = function (tContent, tBody) {\n        var tr = createElement('tr', { attrs: { role: 'row' } });\n        var ntr;\n        var td = createElement('td', { attrs: { role: 'gridcell', 'aria-selected': 'false' } });\n        var tempData;\n        var rowSpan = 0;\n        var level;\n        if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n            var tContentCollection = [];\n            var parentCollection = this.parent.resourceBase.resourceCollection.slice(0, -1);\n            for (var w = 0; w < tContent.length; w++) {\n                tContentCollection = tContentCollection.concat(tContent[w]);\n            }\n            level = (parentCollection.length > 0) ? 'parentColumnLevel_' + parentCollection.length : 'resourceColumn';\n            var rowSpanCollection = tContentCollection.filter(function (data) { return data.type === level; });\n            for (var x = 0; x < rowSpanCollection.length; x++) {\n                rowSpan = rowSpan + rowSpanCollection[x].rowSpan;\n            }\n        }\n        for (var row = 0; row < tContent.length; row++) {\n            ntr = tr.cloneNode();\n            for (var col = tContent[row].length - 1; col >= 0; col--) {\n                var data = tContent[row][col];\n                var ntd = td.cloneNode();\n                if (data.type === 'dateColumn') {\n                    if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n                        tempData = tContent[row][col];\n                        continue;\n                    }\n                    ntd.setAttribute('data-date', data.date.getTime().toString());\n                    ntd.appendChild(this.createDateHeaderElement(data.date));\n                    var className = [cls.AGENDA_CELLS_CLASS, cls.AGENDA_DATE_CLASS];\n                    if (data.cssClass) {\n                        className.push(data.cssClass);\n                    }\n                    addClass([ntd], className);\n                    ntr.appendChild(ntd);\n                }\n                else if (data.type === 'eventColumn') {\n                    var elementType = (data.eventData.length === 0) ? 'noEvents' : 'data';\n                    ntd = this.createAgendaContentElement(elementType, data.eventData, ntd, data.groupOrder, data.groupIndex);\n                    ntd.setAttribute('data-date', data.date.getTime().toString());\n                    if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n                        addClass([ntd], [cls.AGENDA_CELLS_CLASS, cls.AGENDA_DAY_PADDING_CLASS]);\n                    }\n                    ntr.appendChild(ntd);\n                }\n                else {\n                    ntd.setAttribute('rowspan', data.rowSpan.toString());\n                    addClass([ntd], cls.AGENDA_RESOURCE_CLASS);\n                    this.setResourceHeaderContent(ntd, data, data.className[0]);\n                    ntr.appendChild(ntd);\n                }\n            }\n            if (this.parent.activeViewOptions.group.byDate && row === 0 && this.parent.currentView !== 'MonthAgenda') {\n                var ntd = td.cloneNode();\n                ntd.setAttribute('data-date', tempData.date.getTime().toString());\n                ntd.setAttribute('rowspan', rowSpan.toString());\n                ntd.appendChild(this.createDateHeaderElement(tempData.date));\n                addClass([ntd], [cls.AGENDA_CELLS_CLASS, cls.AGENDA_DATE_CLASS, cls.DATE_BORDER_CLASS]);\n                var daysCount = util.getDaysCount(this.parent.selectedDate.getTime(), tempData.date.getTime());\n                ntr.setAttribute('aria-rowindex', daysCount.toString());\n                if (this.parent.element.querySelector(\".e-agenda-view tr[aria-rowindex=\\\"\" + daysCount + \"\\\"]\")) {\n                    break;\n                }\n                ntr.insertBefore(ntd, ntr.childNodes[0]);\n            }\n            tBody.appendChild(ntr);\n        }\n    };\n    AgendaBase.prototype.createDateHeaderElement = function (date) {\n        var dateHeader;\n        if (this.parent.activeViewOptions.dateHeaderTemplate) {\n            dateHeader = createElement('div', { className: cls.AGENDA_HEADER_CLASS });\n            var args = { date: date, type: 'dateHeader' };\n            var scheduleId = this.parent.element.id + '_';\n            var viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n            var templateId = scheduleId + viewName + 'dateHeaderTemplate';\n            var dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(args, this.parent, 'dateHeaderTemplate', templateId, false));\n            append(dateTemplate, dateHeader);\n        }\n        else {\n            dateHeader = this.getMobileDateElement(date, cls.AGENDA_HEADER_CLASS);\n        }\n        return dateHeader;\n    };\n    AgendaBase.prototype.renderEmptyContent = function (tBody, agendaDate) {\n        var eTr = this.createTableRowElement(agendaDate, 'noEvents');\n        var eTd = eTr.children[0];\n        var noEvents = createElement('div', {\n            className: cls.AGENDA_EMPTY_EVENT_CLASS,\n            innerHTML: this.parent.localeObj.getConstant('noEvents')\n        });\n        eTd.appendChild(noEvents);\n        tBody.appendChild(eTr);\n    };\n    AgendaBase.prototype.createTableRowElement = function (date, type) {\n        var daysCount = util.getDaysCount(this.parent.selectedDate.getTime(), date.getTime());\n        var tr = createElement('tr', { attrs: { 'role': 'row', 'aria-rowindex': daysCount.toString() } });\n        var td = createElement('td', {\n            attrs: {\n                'class': (type === 'monthHeader') ? cls.MONTH_HEADER_CLASS : cls.AGENDA_CELLS_CLASS,\n                'role': 'gridcell',\n                'aria-selected': 'false',\n                'aria-colindex': daysCount.toString(),\n                'data-date': date.getTime().toString()\n            }\n        });\n        var dTd = td.cloneNode();\n        var aTd = td.cloneNode();\n        tr.appendChild(dTd);\n        if (type !== 'noEvents') {\n            tr.appendChild(aTd);\n        }\n        return tr;\n    };\n    AgendaBase.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n    };\n    return AgendaBase;\n}(ViewBase));\nexport { AgendaBase };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}