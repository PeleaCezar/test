{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nimport { append, prepend, createElement, extend, EventHandler, closest, addClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, setStyleAttribute, remove } from '@syncfusion/ej2-base';\nimport { EventBase } from './event-base';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar EVENT_GAP = 0;\n/**\n * Month view events render\n */\n\nvar MonthEvent =\n/** @class */\nfunction (_super) {\n  __extends(MonthEvent, _super);\n\n  function MonthEvent(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.renderedEvents = [];\n    _this.monthHeaderHeight = 0;\n    _this.moreIndicatorHeight = 19;\n    _this.renderType = 'day';\n    _this.element = _this.parent.activeView.getPanel();\n    _this.fields = _this.parent.eventFields;\n    _this.maxHeight = _this.parent.eventSettings.enableMaxHeight && !_this.parent.eventSettings.enableIndicator && !_this.parent.rowAutoHeight;\n    _this.withIndicator = _this.parent.eventSettings.enableMaxHeight && _this.parent.eventSettings.enableIndicator && !_this.parent.rowAutoHeight;\n    _this.maxOrIndicator = _this.maxHeight || _this.withIndicator;\n    _this.moreIndicatorHeight = _this.parent.rowAutoHeight && _this.parent.eventSettings.ignoreWhitespace ? 0 : _this.moreIndicatorHeight;\n\n    _this.addEventListener();\n\n    return _this;\n  }\n\n  MonthEvent.prototype.removeEventWrapper = function (appElement) {\n    if (appElement.length > 0) {\n      appElement = this.parent.currentView === 'Month' ? appElement : [appElement[0]];\n\n      for (var _i = 0, appElement_1 = appElement; _i < appElement_1.length; _i++) {\n        var wrap = appElement_1[_i];\n\n        if (wrap.parentElement && wrap.parentElement.parentNode) {\n          remove(wrap.parentElement);\n        }\n      }\n    }\n  };\n\n  MonthEvent.prototype.renderAppointments = function () {\n    if (this.parent.dragAndDropModule) {\n      this.parent.dragAndDropModule.setDragArea();\n    }\n\n    var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n\n    if (this.parent.rowAutoHeight) {\n      this.parent.uiStateValues.top = conWrap.scrollTop;\n      this.parent.uiStateValues.left = conWrap.scrollLeft;\n    }\n\n    var appointmentWrapper = [].slice.call(this.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n\n    if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n      for (var i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n        var appElement = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' + this.parent.crudModule.crudObj.sourceEvent[i].groupIndex + '\"]'));\n        this.removeEventWrapper(appElement);\n\n        if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !== this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n          var ele = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' + this.parent.crudModule.crudObj.targetEvent[i].groupIndex + '\"]'));\n          this.removeEventWrapper(ele);\n        }\n      }\n    } else {\n      for (var _i = 0, appointmentWrapper_1 = appointmentWrapper; _i < appointmentWrapper_1.length; _i++) {\n        var wrap = appointmentWrapper_1[_i];\n        remove(wrap);\n      }\n    }\n\n    this.removeHeightProperty(cls.CONTENT_TABLE_CLASS);\n\n    if (!this.element.querySelector('.' + cls.WORK_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.currentView === 'Month') {\n      var wrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      var cellTd = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n      cellTd.appendChild(wrapper);\n      this.monthHeaderHeight = wrapper.offsetTop - cellTd.offsetTop;\n      cellTd.removeChild(wrapper);\n    }\n\n    this.eventHeight = util.getElementHeightFromClass(this.element, cls.APPOINTMENT_CLASS);\n    var scrollTop = conWrap.scrollTop;\n\n    if (this.parent.rowAutoHeight && this.parent.virtualScrollModule && !isNullOrUndefined(this.parent.currentAction)) {\n      conWrap.scrollTop = conWrap.scrollTop - 1;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.renderResourceEvents();\n\n      if (this.parent.virtualScrollModule) {\n        this.parent.virtualScrollModule.updateFocusedWorkCell();\n      }\n    } else {\n      this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays);\n    }\n\n    if (this.parent.rowAutoHeight) {\n      this.updateBlockElements();\n      var data = {\n        cssProperties: this.parent.getCssProperties(),\n        module: this.parent.getModuleName(),\n        isPreventScrollUpdate: true,\n        scrollPosition: {\n          left: this.parent.uiStateValues.left,\n          top: this.parent.uiStateValues.top\n        }\n      };\n\n      if (this.parent.virtualScrollModule) {\n        if (this.parent.currentAction) {\n          conWrap.scrollTop = scrollTop;\n          this.parent.currentAction = null;\n        } else {\n          this.parent.virtualScrollModule.updateVirtualScrollHeight();\n        }\n      }\n\n      if (!this.parent.enablePersistence) {\n        this.parent.notify(events.contentReady, {});\n      }\n\n      this.parent.notify(events.scrollUiUpdate, data);\n\n      if (this.parent.currentView === 'Month' && this.parent.showWeekNumber) {\n        var totalCells_1 = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n        var weekNumberCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WEEK_NUMBER_CLASS));\n        weekNumberCells.forEach(function (cell, i) {\n          var height = totalCells_1[i].offsetHeight;\n          setStyleAttribute(cell, {\n            'height': height + 'px'\n          });\n        });\n        this.parent.element.querySelector('.' + cls.WEEK_NUMBER_WRAPPER_CLASS).scrollTop = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS).scrollTop;\n      }\n    }\n\n    this.parent.renderTemplates();\n  };\n\n  MonthEvent.prototype.renderEventsHandler = function (dateRender, workDays, resData) {\n    this.renderedEvents = [];\n    var eventsList;\n    var blockList;\n    var resIndex = 0;\n\n    if (resData) {\n      resIndex = resData.groupIndex;\n      this.cssClass = resData.cssClass;\n      this.groupOrder = resData.groupOrder;\n      eventsList = this.parent.eventBase.filterEventsByResource(resData, this.parent.eventsProcessed);\n      blockList = this.parent.eventBase.filterEventsByResource(resData, this.parent.blockProcessed);\n      this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS + '[data-group-index=\"' + resIndex + '\"]'));\n    } else {\n      eventsList = this.parent.eventsProcessed;\n      blockList = this.parent.blockProcessed;\n      this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n    }\n\n    this.sortByDateTime(eventsList);\n    this.sortByDateTime(blockList);\n\n    if (this.parent.currentView === 'Month' && this.parent.rowAutoHeight && this.parent.activeViewOptions.group.resources.length === 0) {\n      var totalCells = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n      var height_1 = this.parent.height === 'auto' ? (this.parent.element.querySelector('.e-content-wrap').clientHeight + this.parent.element.querySelector('.e-date-header-wrap').clientHeight) / totalCells.length : this.parent.element.querySelector('.e-schedule-table').clientHeight / totalCells.length;\n      totalCells.forEach(function (cell) {\n        setStyleAttribute(cell, {\n          'height': height_1 + 'px'\n        });\n      });\n    }\n\n    var cellDetail = this.workCells[this.parent.activeView.isTimelineView() ? 0 : this.workCells.length - 1].getBoundingClientRect();\n    this.cellWidth = cellDetail.width;\n    this.cellHeight = cellDetail.height;\n    this.dateRender = dateRender;\n    var filteredDates = this.getRenderedDates(dateRender);\n    this.getSlotDates(workDays || this.parent.activeViewOptions.workDays);\n    this.processBlockEvents(blockList, resIndex, resData);\n    var events = [];\n\n    for (var _i = 0, eventsList_1 = eventsList; _i < eventsList_1.length; _i++) {\n      var event_1 = eventsList_1[_i];\n\n      if (this.parent.resourceBase && !resData) {\n        this.cssClass = this.parent.resourceBase.getCssClass(event_1);\n      }\n\n      events = events.concat(this.splitEvent(event_1, filteredDates || this.dateRender));\n    }\n\n    for (var level = 0; level < this.slots.length; level++) {\n      this.renderedEvents = [];\n      var slot = this.slots[level];\n      var endDate = util.addDays(new Date(slot[slot.length - 1]), 1);\n      var spannedEvents = this.filterEvents(new Date(slot[0]), endDate, events);\n\n      for (var _a = 0, spannedEvents_1 = spannedEvents; _a < spannedEvents_1.length; _a++) {\n        var event_2 = spannedEvents_1[_a];\n\n        if (this.maxHeight) {\n          var sDate = this.parent.currentView === 'Month' ? event_2[this.fields.startTime] : this.getStartTime(event_2, event_2.data);\n\n          if (this.getIndex(sDate) > 0) {\n            continue;\n          }\n        }\n\n        this.updateIndicatorIcon(event_2);\n        this.renderEvents(event_2, resIndex, eventsList);\n      }\n    }\n\n    this.cssClass = null;\n    this.groupOrder = null;\n  };\n\n  MonthEvent.prototype.processBlockEvents = function (blockEvents, resIndex, resData) {\n    for (var _i = 0, blockEvents_1 = blockEvents; _i < blockEvents_1.length; _i++) {\n      var event_3 = blockEvents_1[_i];\n\n      if (this.parent.resourceBase && !resData) {\n        this.cssClass = this.parent.resourceBase.getCssClass(event_3);\n      }\n\n      var blockSpannedList = [];\n\n      if (this.renderType === 'day' && !event_3[this.fields.isAllDay]) {\n        var temp = extend({}, event_3, null, true);\n        var isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n        temp.isBlockIcon = isSameDate;\n\n        if (!isSameDate && util.getDateInMs(temp[this.fields.startTime]) > 0) {\n          var e = extend({}, event_3, null, true);\n          e[this.fields.endTime] = util.addDays(util.resetTime(new Date(event_3[this.fields.startTime] + '')), 1);\n          e.isBlockIcon = true;\n          temp[this.fields.startTime] = e[this.fields.endTime];\n          blockSpannedList.push(e);\n        }\n\n        isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n\n        if (!isSameDate && util.getDateInMs(temp[this.fields.endTime]) > 0) {\n          var e = extend({}, event_3, null, true);\n          e[this.fields.startTime] = util.resetTime(new Date(event_3[this.fields.endTime] + ''));\n          e.isBlockIcon = true;\n          blockSpannedList.push(e);\n          temp[this.fields.endTime] = e[this.fields.startTime];\n        }\n\n        blockSpannedList.push(temp);\n      } else {\n        blockSpannedList.push(event_3);\n      }\n\n      for (var _a = 0, blockSpannedList_1 = blockSpannedList; _a < blockSpannedList_1.length; _a++) {\n        var blockEvent = blockSpannedList_1[_a];\n        var spannedEvents = this.splitEvent(blockEvent, this.dateRender);\n\n        for (var _b = 0, spannedEvents_2 = spannedEvents; _b < spannedEvents_2.length; _b++) {\n          var event_4 = spannedEvents_2[_b];\n          this.renderBlockEvents(event_4, resIndex, !!blockEvent.isBlockIcon);\n        }\n      }\n    }\n  };\n\n  MonthEvent.prototype.isSameDate = function (start, end) {\n    return new Date(+start).setHours(0, 0, 0, 0) === new Date(+end).setHours(0, 0, 0, 0);\n  };\n\n  MonthEvent.prototype.renderBlockEvents = function (event, resIndex, isIcon) {\n    var eventData = event.data;\n    var startTime = this.getStartTime(event, eventData);\n    var endTime = this.getEndTime(event, eventData);\n    var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n\n    if (day < 0 || startTime > endTime) {\n      return;\n    }\n\n    var cellTd = this.getCellTd(day);\n    var position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], day);\n\n    if (!isIcon) {\n      var diffInDays = eventData.count;\n      var appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n      appWidth = appWidth <= 0 ? this.cellWidth : appWidth;\n      var appLeft = this.parent.enableRtl ? 0 : position;\n      var appRight = this.parent.enableRtl ? position : 0;\n      var appHeight = this.cellHeight - this.monthHeaderHeight;\n      var appTop = this.getRowTop(resIndex);\n      var blockElement = this.createBlockAppointmentElement(event, resIndex);\n      setStyleAttribute(blockElement, {\n        'width': appWidth + 'px',\n        'height': appHeight + 'px',\n        'left': appLeft + 'px',\n        'right': appRight + 'px',\n        'top': appTop + 'px'\n      });\n      this.renderEventElement(event, blockElement, cellTd);\n    } else {\n      this.renderBlockIndicator(cellTd, position, resIndex);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  MonthEvent.prototype.renderBlockIndicator = function (cellTd, position, resIndex) {\n    var blockIndicator = createElement('div', {\n      className: 'e-icons ' + cls.BLOCK_INDICATOR_CLASS\n    });\n\n    if (isNullOrUndefined(cellTd.querySelector('.' + cls.BLOCK_INDICATOR_CLASS))) {\n      cellTd.appendChild(blockIndicator);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  MonthEvent.prototype.getStartTime = function (event, eventData) {\n    return event[this.fields.startTime];\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  MonthEvent.prototype.getEndTime = function (event, eventData) {\n    return event[this.fields.endTime];\n  };\n\n  MonthEvent.prototype.getCellTd = function (day) {\n    return this.workCells[day];\n  };\n\n  MonthEvent.prototype.getEventWidth = function (startDate, endDate, isAllDay, count) {\n    return count * this.cellWidth - 1;\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  MonthEvent.prototype.getPosition = function (startTime, endTime, isAllDay, day) {\n    return 0;\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  MonthEvent.prototype.getRowTop = function (resIndex) {\n    return 0;\n  };\n\n  MonthEvent.prototype.updateIndicatorIcon = function (event) {\n    if (this.parent.currentView.indexOf('Timeline') === -1 || this.parent.currentView === 'TimelineMonth' || event[this.fields.isAllDay]) {\n      return;\n    }\n\n    var cloneData = event.data;\n    var start = this.parent.activeView.getStartHour();\n    var end = this.parent.activeView.getEndHour();\n    var startHour = util.getStartEndHours(event[this.fields.startTime], start, end);\n    var endHour = util.getStartEndHours(event[this.fields.endTime], start, end);\n    var actualStartTime = cloneData[this.fields.startTime];\n    var actualEndTime = cloneData[this.fields.endTime];\n    cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() < startHour.startHour.getTime();\n    cloneData.isRight = cloneData.isRight || actualEndTime.getTime() > endHour.endHour.getTime();\n\n    if (util.resetTime(actualStartTime).getTime() !== util.resetTime(actualEndTime).getTime()) {\n      var actualStartHour = startHour.startHour;\n      var actualEndHour = endHour.endHour;\n      var startTime = new Date(util.resetTime(actualStartTime));\n      startTime.setHours(actualEndHour.getHours(), actualEndHour.getMinutes(), actualEndHour.getSeconds());\n      cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() >= (actualStartHour.getDate() === startHour.endHour.getDate() ? startTime.getTime() : util.addDays(startTime, 1).getTime());\n\n      if (actualEndTime.getTime() !== util.resetTime(actualEndTime).getTime()) {\n        var endTime = new Date(util.resetTime(actualEndTime));\n        cloneData.isRight = cloneData.isRight || actualEndTime.getTime() <= endTime.setHours(actualStartHour.getHours(), actualStartHour.getMinutes(), actualStartHour.getSeconds());\n      }\n    }\n  };\n\n  MonthEvent.prototype.renderResourceEvents = function () {\n    var resources = this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.lastResourceLevel;\n\n    if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n      for (var i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n        var sourceRes = this.parent.crudModule.crudObj.sourceEvent[i];\n        this.renderEventsHandler(sourceRes.renderDates, sourceRes.workDays, sourceRes);\n\n        if (this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !== this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n          var target = this.parent.crudModule.crudObj.targetEvent[i];\n          this.renderEventsHandler(target.renderDates, target.workDays, target);\n        }\n      }\n\n      this.parent.crudModule.crudObj.isCrudAction = false;\n    } else {\n      for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n        var slotData = resources_1[_i];\n        this.renderEventsHandler(slotData.renderDates, slotData.workDays, slotData);\n      }\n    }\n  };\n\n  MonthEvent.prototype.getSlotDates = function (workDays) {\n    this.slots = [];\n    var dates = this.dateRender.map(function (date) {\n      return +date;\n    });\n    var noOfDays = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : workDays.length;\n\n    while (dates.length > 0) {\n      this.slots.push(dates.splice(0, noOfDays));\n    }\n  };\n\n  MonthEvent.prototype.createAppointmentElement = function (record, resIndex, isCloneElement) {\n    if (isCloneElement === void 0) {\n      isCloneElement = false;\n    }\n\n    var eventSubject = record[this.fields.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    var newRecord = extend({}, record, record.data, true);\n    var attrs = {\n      'data-id': 'Appointment_' + record[this.fields.id],\n      'role': 'button',\n      'tabindex': '0',\n      'aria-readonly': this.parent.eventBase.getReadonlyAttribute(record),\n      'aria-selected': 'false',\n      'aria-grabbed': 'true',\n      'aria-label': this.parent.getAnnouncementString(newRecord, eventSubject)\n    };\n\n    if (!isCloneElement) {\n      attrs['data-guid'] = record.Guid;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      attrs['data-group-index'] = resIndex.toString();\n    }\n\n    var appointmentWrapper = createElement('div', {\n      className: cls.APPOINTMENT_CLASS,\n      attrs: attrs\n    });\n\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n\n    if (record[this.fields.isReadonly]) {\n      addClass([appointmentWrapper], 'e-read-only');\n    }\n\n    var appointmentDetails = createElement('div', {\n      className: cls.APPOINTMENT_DETAILS\n    });\n    appointmentWrapper.appendChild(appointmentDetails);\n    var templateElement;\n    var eventData = record.data;\n    var eventObj = this.getEventData(record);\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      var scheduleId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.eventTemplateName;\n      var templateId = scheduleId + viewName + 'eventTemplate';\n      var eventTemplate = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 ? '_' + resIndex : '');\n      templateElement = this.parent.getAppointmentTemplate()(eventObj, this.parent, eventTemplate, templateId, false);\n    } else {\n      var eventLocation = record[this.fields.location] || this.parent.eventSettings.fields.location.default || '';\n      var appointmentSubject = createElement('div', {\n        className: cls.SUBJECT_CLASS,\n        innerHTML: eventSubject + (eventLocation ? ';&nbsp' + eventLocation : '')\n      });\n      var appointmentStartTime = createElement('div', {\n        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventData[this.fields.startTime])\n      });\n      var appointmentEndTime = createElement('div', {\n        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventData[this.fields.endTime])\n      });\n\n      if (this.parent.currentView === 'Month') {\n        if (record[this.fields.isAllDay]) {\n          templateElement = [appointmentSubject];\n          addClass([appointmentSubject], 'e-text-center');\n        } else if (eventData.count <= 1 && !eventData.isLeft && !eventData.isRight) {\n          templateElement = [appointmentStartTime, appointmentSubject];\n        } else {\n          templateElement = [];\n          addClass([appointmentSubject], 'e-text-center');\n\n          if (!eventData.isLeft) {\n            templateElement.push(appointmentStartTime);\n          }\n\n          templateElement.push(appointmentSubject);\n\n          if (!eventData.isRight) {\n            templateElement.push(appointmentEndTime);\n          }\n        }\n      } else {\n        var innerElement = void 0;\n\n        if (record[this.fields.isAllDay]) {\n          var allDayString = createElement('div', {\n            className: cls.APPOINTMENT_TIME,\n            innerHTML: this.parent.localeObj.getConstant('allDay')\n          });\n          innerElement = [appointmentSubject, allDayString];\n        } else {\n          var timeString = this.parent.getTimeString(eventData[this.fields.startTime]) + ' - ' + this.parent.getTimeString(eventData[this.fields.endTime]);\n          var appTime = createElement('div', {\n            className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n            innerHTML: timeString\n          });\n          var appLocation = createElement('div', {\n            className: cls.LOCATION_CLASS,\n            innerHTML: eventLocation\n          });\n          innerElement = [appointmentSubject, appTime, appLocation];\n        }\n\n        var wrap = createElement('div', {\n          className: 'e-inner-wrap'\n        });\n        append(innerElement, wrap);\n        templateElement = [wrap];\n      }\n    }\n\n    append(templateElement, appointmentDetails);\n    this.appendEventIcons(record, appointmentDetails);\n    this.renderResizeHandler(appointmentWrapper, record.data, record[this.fields.isReadonly]);\n    return appointmentWrapper;\n  };\n\n  MonthEvent.prototype.appendEventIcons = function (record, appointmentDetails) {\n    var eventData = record.data;\n\n    if (!isNullOrUndefined(record[this.fields.recurrenceRule]) || !isNullOrUndefined(record[this.fields.recurrenceID])) {\n      var iconClass = record[this.fields.id] === record[this.fields.recurrenceID] ? cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      appointmentDetails.appendChild(createElement('div', {\n        className: cls.ICON + ' ' + iconClass + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : '')\n      }));\n    }\n\n    if (eventData.isLeft) {\n      var iconLeft = createElement('div', {\n        className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_LEFT_CLASS\n      });\n      prepend([iconLeft], appointmentDetails);\n    }\n\n    if (eventData.isRight) {\n      var iconRight = createElement('div', {\n        className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_RIGHT_CLASS\n      });\n      append([iconRight], appointmentDetails);\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  MonthEvent.prototype.renderEvents = function (event, resIndex, eventsList) {\n    var startTime = event[this.fields.startTime];\n    var endTime = event[this.fields.endTime];\n    var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(startTime));\n\n    if (day < 0 || startTime.getTime() < this.parent.minDate.getTime() || endTime.getTime() > this.parent.maxDate.getTime()) {\n      return;\n    }\n\n    var overlapCount = this.getIndex(startTime);\n    event.Index = overlapCount;\n    var diffInDays = event.data.count;\n\n    if (startTime.getTime() <= endTime.getTime()) {\n      var appWidth = diffInDays * this.cellWidth - 5;\n      var cellTd = this.workCells[day];\n      var appTop = overlapCount * (this.eventHeight + EVENT_GAP);\n      var height = this.monthHeaderHeight + (overlapCount + 1) * (this.eventHeight + EVENT_GAP) + this.moreIndicatorHeight;\n      var enableAppRender = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n\n      if (this.parent.rowAutoHeight || enableAppRender) {\n        this.renderedEvents.push(extend({}, event, null, true));\n        var appointmentElement = void 0;\n\n        if (this.inlineValue) {\n          appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n        } else {\n          appointmentElement = this.createAppointmentElement(event, resIndex);\n        }\n\n        this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n        this.wireAppointmentEvents(appointmentElement, event);\n        setStyleAttribute(appointmentElement, {\n          'width': appWidth + 'px',\n          'top': appTop + 'px'\n        });\n        this.renderEventElement(event, appointmentElement, cellTd);\n\n        if (this.parent.rowAutoHeight) {\n          var firstChild = cellTd.parentElement.firstElementChild;\n          this.updateCellHeight(firstChild, height);\n        }\n      } else {\n        for (var i = 0; i < diffInDays; i++) {\n          if (this.workCells[day + i]) {\n            var indicator = this.workCells[day + i].querySelector('.' + cls.MORE_INDICATOR_CLASS);\n\n            if (indicator) {\n              var count = parseInt(indicator.getAttribute('data-count'), 10) + 1;\n              indicator.setAttribute('data-count', count.toString());\n              indicator.innerHTML = this.getMoreIndicatorText(count);\n            } else {\n              var startDate = new Date(this.dateRender[day + i].getTime());\n              var endDate = util.addDays(this.dateRender[day + i], 1);\n              var groupIndex = this.workCells[day + i].getAttribute('data-group-index');\n              var moreIndicatorElement = this.getMoreIndicatorElement(1, startDate, endDate);\n\n              if (!isNullOrUndefined(groupIndex)) {\n                moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n              }\n\n              moreIndicatorElement.style.top = this.cellHeight - this.monthHeaderHeight - this.moreIndicatorHeight + 'px';\n              moreIndicatorElement.style.width = this.cellWidth - 2 + 'px';\n              this.renderElement(this.workCells[day + i], moreIndicatorElement);\n              EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n            }\n          }\n        }\n      }\n    }\n  };\n\n  MonthEvent.prototype.updateCellHeight = function (cell, height) {\n    if (height > cell.offsetHeight) {\n      setStyleAttribute(cell, {\n        'height': height + 'px'\n      });\n    }\n  };\n\n  MonthEvent.prototype.updateBlockElements = function () {\n    var blockElement = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS));\n\n    for (var _i = 0, blockElement_1 = blockElement; _i < blockElement_1.length; _i++) {\n      var element = blockElement_1[_i];\n      var target = closest(element, 'tr');\n      this.monthHeaderHeight = element.offsetParent.offsetTop - target.offsetTop;\n      element.style.height = target.offsetHeight - 1 - this.monthHeaderHeight + 'px';\n      var firstChild = target.firstElementChild;\n      var width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n      element.style.width = firstChild.offsetWidth * width + 'px';\n    }\n  }; // eslint-disable-next-line max-len\n\n\n  MonthEvent.prototype.getFilteredEvents = function (startDate, endDate, groupIndex, eventsList) {\n    var filteredEvents;\n\n    if (isNullOrUndefined(groupIndex)) {\n      filteredEvents = this.filterEvents(startDate, endDate);\n    } else {\n      var data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n      filteredEvents = this.filterEvents(startDate, endDate, isNullOrUndefined(eventsList) ? undefined : eventsList, data);\n    }\n\n    return filteredEvents;\n  };\n\n  MonthEvent.prototype.getOverlapEvents = function (date, appointments) {\n    var appointmentsList = [];\n    var dateTime = util.resetTime(date).getTime();\n\n    for (var _i = 0, appointments_1 = appointments; _i < appointments_1.length; _i++) {\n      var app = appointments_1[_i];\n\n      if (util.resetTime(app[this.fields.startTime]).getTime() <= dateTime && util.resetTime(app[this.fields.endTime]).getTime() >= dateTime) {\n        appointmentsList.push(app);\n      }\n    }\n\n    return appointmentsList;\n  };\n\n  MonthEvent.prototype.getIndex = function (date) {\n    var appIndex = -1;\n    var appointments = this.renderedEvents;\n\n    if (appointments.length > 0) {\n      var appointmentsList = this.getOverlapEvents(date, appointments);\n      var appLevel = appointmentsList.map(function (obj) {\n        return obj.Index;\n      });\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  };\n\n  MonthEvent.prototype.moreIndicatorClick = function (event) {\n    var _this = this;\n\n    var target = closest(event.target, '.' + cls.MORE_INDICATOR_CLASS);\n    var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n    var endDate = new Date(parseInt(target.getAttribute('data-end-date'), 10));\n    var groupIndex = target.getAttribute('data-group-index');\n    var moreArgs = {\n      cancel: false,\n      event: event,\n      element: target,\n      isPopupOpen: true,\n      startTime: startDate,\n      endTime: endDate,\n      viewName: this.parent.getNavigateView()\n    };\n\n    if (groupIndex) {\n      moreArgs.groupIndex = parseInt(groupIndex, 10);\n    }\n\n    this.parent.trigger(events.moreEventsClick, moreArgs, function (clickArgs) {\n      if (!clickArgs.cancel) {\n        if (clickArgs.isPopupOpen) {\n          var filteredEvents = _this.getFilteredEvents(startDate, endDate, groupIndex);\n\n          var moreArgs_1 = {\n            date: startDate,\n            event: filteredEvents,\n            element: event.target\n          };\n\n          _this.parent.quickPopup.moreEventClick(moreArgs_1, endDate, groupIndex);\n        } else {\n          _this.parent.setProperties({\n            selectedDate: startDate\n          }, true);\n\n          _this.parent.changeView(clickArgs.viewName, event);\n        }\n      }\n    });\n  };\n\n  MonthEvent.prototype.renderEventElement = function (event, appointmentElement, cellTd) {\n    var _this = this;\n\n    var eventType = appointmentElement.classList.contains(cls.BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n    var isAppointment = appointmentElement.classList.contains(cls.APPOINTMENT_CLASS);\n    var eventObj = this.getEventData(event);\n    var args = {\n      data: eventObj,\n      element: appointmentElement,\n      cancel: false,\n      type: eventType\n    };\n    this.parent.trigger(events.eventRendered, args, function (eventArgs) {\n      if (eventArgs.cancel) {\n        _this.renderedEvents.pop();\n      } else {\n        _this.renderElement(cellTd, appointmentElement, isAppointment);\n      }\n    });\n  };\n\n  MonthEvent.prototype.getEventData = function (event) {\n    var eventObj = extend({}, event, null, true);\n    eventObj[this.fields.startTime] = event.data[this.fields.startTime];\n    eventObj[this.fields.endTime] = event.data[this.fields.endTime];\n    return eventObj;\n  };\n\n  MonthEvent.prototype.renderElement = function (cellTd, element, isAppointment) {\n    if (isAppointment === void 0) {\n      isAppointment = false;\n    }\n\n    if (this.maxOrIndicator && isAppointment) {\n      this.setMaxEventHeight(element, cellTd);\n    }\n\n    var wrapperEle = cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n\n    if (wrapperEle) {\n      wrapperEle.appendChild(element);\n    } else {\n      var wrapper = createElement('div', {\n        className: cls.APPOINTMENT_WRAPPER_CLASS\n      });\n      wrapper.appendChild(element);\n      cellTd.appendChild(wrapper);\n    }\n  };\n\n  MonthEvent.prototype.getMoreIndicatorElement = function (count, startDate, endDate) {\n    var moreIndicatorElement = createElement('div', {\n      className: cls.MORE_INDICATOR_CLASS,\n      innerHTML: this.getMoreIndicatorText(count),\n      attrs: {\n        'tabindex': '0',\n        'data-count': count.toString(),\n        'data-start-date': startDate.getTime().toString(),\n        'data-end-date': endDate.getTime().toString(),\n        'role': 'list'\n      }\n    });\n    return moreIndicatorElement;\n  };\n\n  MonthEvent.prototype.getMoreIndicatorText = function (count) {\n    return '+' + this.parent.globalize.formatNumber(count) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n  };\n\n  MonthEvent.prototype.removeHeightProperty = function (selector) {\n    var rows = [].slice.call(this.element.querySelectorAll('.' + selector + ' tbody tr'));\n\n    for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n      var row = rows_1[_i];\n      row.firstElementChild.style.height = '';\n    }\n  };\n\n  MonthEvent.prototype.setMaxEventHeight = function (event, cell) {\n    var headerHeight = util.getOuterHeight(cell.querySelector('.' + cls.DATE_HEADER_CLASS));\n    var height = cell.offsetHeight - headerHeight - (this.maxHeight ? 0 : this.moreIndicatorHeight);\n    setStyleAttribute(event, {\n      'height': height + 'px',\n      'align-items': 'center'\n    });\n  };\n\n  MonthEvent.prototype.destroy = function () {\n    this.element = null;\n    this.fields = null;\n    this.maxHeight = null;\n    this.withIndicator = null;\n    this.maxOrIndicator = null;\n    this.moreIndicatorHeight = null;\n    this.removeEventListener();\n\n    _super.prototype.destroy.call(this);\n  };\n\n  return MonthEvent;\n}(EventBase);\n\nexport { MonthEvent };","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","append","prepend","createElement","extend","EventHandler","closest","addClass","isNullOrUndefined","setStyleAttribute","remove","EventBase","cls","events","util","EVENT_GAP","MonthEvent","_super","parent","_this","call","renderedEvents","monthHeaderHeight","moreIndicatorHeight","renderType","element","activeView","getPanel","fields","eventFields","maxHeight","eventSettings","enableMaxHeight","enableIndicator","rowAutoHeight","withIndicator","maxOrIndicator","ignoreWhitespace","addEventListener","removeEventWrapper","appElement","length","currentView","_i","appElement_1","wrap","parentElement","parentNode","renderAppointments","dragAndDropModule","setDragArea","conWrap","querySelector","CONTENT_WRAP_CLASS","uiStateValues","top","scrollTop","left","scrollLeft","appointmentWrapper","slice","querySelectorAll","APPOINTMENT_WRAPPER_CLASS","crudModule","crudObj","isCrudAction","i","len","sourceEvent","groupIndex","targetEvent","ele","appointmentWrapper_1","removeHeightProperty","CONTENT_TABLE_CLASS","WORK_CELLS_CLASS","wrapper","className","cellTd","appendChild","offsetTop","removeChild","eventHeight","getElementHeightFromClass","APPOINTMENT_CLASS","virtualScrollModule","currentAction","activeViewOptions","group","resources","renderResourceEvents","updateFocusedWorkCell","renderEventsHandler","renderDates","workDays","updateBlockElements","data","cssProperties","getCssProperties","module","getModuleName","isPreventScrollUpdate","scrollPosition","updateVirtualScrollHeight","enablePersistence","notify","contentReady","scrollUiUpdate","showWeekNumber","totalCells_1","weekNumberCells","WEEK_NUMBER_CLASS","forEach","cell","height","offsetHeight","WEEK_NUMBER_WRAPPER_CLASS","renderTemplates","dateRender","resData","eventsList","blockList","resIndex","cssClass","groupOrder","eventBase","filterEventsByResource","eventsProcessed","blockProcessed","workCells","sortByDateTime","totalCells","height_1","clientHeight","cellDetail","isTimelineView","getBoundingClientRect","cellWidth","width","cellHeight","filteredDates","getRenderedDates","getSlotDates","processBlockEvents","eventsList_1","event_1","resourceBase","getCssClass","concat","splitEvent","level","slots","slot","endDate","addDays","Date","spannedEvents","filterEvents","_a","spannedEvents_1","event_2","sDate","startTime","getStartTime","getIndex","updateIndicatorIcon","renderEvents","blockEvents","blockEvents_1","event_3","blockSpannedList","isAllDay","temp","isSameDate","endTime","isBlockIcon","getDateInMs","e","resetTime","push","blockSpannedList_1","blockEvent","_b","spannedEvents_2","event_4","renderBlockEvents","start","end","setHours","event","isIcon","eventData","getEndTime","day","getIndexOfDate","getTime","getCellTd","position","getPosition","diffInDays","count","appWidth","getEventWidth","appLeft","enableRtl","appRight","appHeight","appTop","getRowTop","blockElement","createBlockAppointmentElement","renderEventElement","renderBlockIndicator","blockIndicator","BLOCK_INDICATOR_CLASS","startDate","indexOf","cloneData","getStartHour","getEndHour","startHour","getStartEndHours","endHour","actualStartTime","actualEndTime","isLeft","isRight","actualStartHour","actualEndHour","getHours","getMinutes","getSeconds","getDate","isGroupAdaptive","lastResourceLevel","sourceRes","target","resources_1","slotData","dates","map","date","noOfDays","showWeekend","WEEK_LENGTH","splice","createAppointmentElement","record","isCloneElement","eventSubject","subject","default","localeObj","getConstant","newRecord","attrs","id","getReadonlyAttribute","getAnnouncementString","Guid","toString","isReadonly","appointmentDetails","APPOINTMENT_DETAILS","templateElement","eventObj","getEventData","eventTemplate","scheduleId","viewName","eventTemplateName","templateId","getAppointmentTemplate","eventLocation","location","appointmentSubject","SUBJECT_CLASS","innerHTML","appointmentStartTime","APPOINTMENT_TIME","isAdaptive","DISABLE_CLASS","getTimeString","appointmentEndTime","innerElement","allDayString","timeString","appTime","appLocation","LOCATION_CLASS","appendEventIcons","renderResizeHandler","recurrenceRule","recurrenceID","iconClass","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","ICON","iconLeft","EVENT_INDICATOR_CLASS","EVENT_ICON_LEFT_CLASS","iconRight","EVENT_ICON_RIGHT_CLASS","minDate","maxDate","overlapCount","Index","enableAppRender","appointmentElement","inlineValue","inlineModule","createInlineAppointmentElement","applyResourceColor","wireAppointmentEvents","firstChild","firstElementChild","updateCellHeight","indicator","MORE_INDICATOR_CLASS","parseInt","getAttribute","setAttribute","getMoreIndicatorText","moreIndicatorElement","getMoreIndicatorElement","style","renderElement","add","moreIndicatorClick","BLOCK_APPOINTMENT_CLASS","blockElement_1","offsetParent","Math","round","offsetWidth","getFilteredEvents","filteredEvents","undefined","getOverlapEvents","appointments","appointmentsList","dateTime","appointments_1","app","appIndex","appLevel","obj","getSmallestMissingNumber","moreArgs","cancel","isPopupOpen","getNavigateView","trigger","moreEventsClick","clickArgs","moreArgs_1","quickPopup","moreEventClick","setProperties","selectedDate","changeView","eventType","classList","contains","isAppointment","args","type","eventRendered","eventArgs","pop","setMaxEventHeight","wrapperEle","globalize","formatNumber","selector","rows","rows_1","row","headerHeight","getOuterHeight","DATE_HEADER_CLASS","destroy","removeEventListener"],"sources":["C:/Users/cpelea/OneDrive - ENDAVA/Desktop/apps/test/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/month.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { append, prepend, createElement, extend, EventHandler, closest, addClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, setStyleAttribute, remove } from '@syncfusion/ej2-base';\nimport { EventBase } from './event-base';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\nvar EVENT_GAP = 0;\n/**\n * Month view events render\n */\nvar MonthEvent = /** @class */ (function (_super) {\n    __extends(MonthEvent, _super);\n    function MonthEvent(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.renderedEvents = [];\n        _this.monthHeaderHeight = 0;\n        _this.moreIndicatorHeight = 19;\n        _this.renderType = 'day';\n        _this.element = _this.parent.activeView.getPanel();\n        _this.fields = _this.parent.eventFields;\n        _this.maxHeight = _this.parent.eventSettings.enableMaxHeight && !_this.parent.eventSettings.enableIndicator\n            && !_this.parent.rowAutoHeight;\n        _this.withIndicator = _this.parent.eventSettings.enableMaxHeight && _this.parent.eventSettings.enableIndicator\n            && !_this.parent.rowAutoHeight;\n        _this.maxOrIndicator = (_this.maxHeight || _this.withIndicator);\n        _this.moreIndicatorHeight =\n            (_this.parent.rowAutoHeight && _this.parent.eventSettings.ignoreWhitespace) ? 0 : _this.moreIndicatorHeight;\n        _this.addEventListener();\n        return _this;\n    }\n    MonthEvent.prototype.removeEventWrapper = function (appElement) {\n        if (appElement.length > 0) {\n            appElement = (this.parent.currentView === 'Month') ? appElement : [appElement[0]];\n            for (var _i = 0, appElement_1 = appElement; _i < appElement_1.length; _i++) {\n                var wrap = appElement_1[_i];\n                if (wrap.parentElement && wrap.parentElement.parentNode) {\n                    remove(wrap.parentElement);\n                }\n            }\n        }\n    };\n    MonthEvent.prototype.renderAppointments = function () {\n        if (this.parent.dragAndDropModule) {\n            this.parent.dragAndDropModule.setDragArea();\n        }\n        var conWrap = this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n        if (this.parent.rowAutoHeight) {\n            this.parent.uiStateValues.top = conWrap.scrollTop;\n            this.parent.uiStateValues.left = conWrap.scrollLeft;\n        }\n        var appointmentWrapper = [].slice.call(this.element.querySelectorAll('.' + cls.APPOINTMENT_WRAPPER_CLASS));\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n            for (var i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                var appElement = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' +\n                    this.parent.crudModule.crudObj.sourceEvent[i].groupIndex + '\"]'));\n                this.removeEventWrapper(appElement);\n                if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                    this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n                    var ele = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' +\n                        this.parent.crudModule.crudObj.targetEvent[i].groupIndex + '\"]'));\n                    this.removeEventWrapper(ele);\n                }\n            }\n        }\n        else {\n            for (var _i = 0, appointmentWrapper_1 = appointmentWrapper; _i < appointmentWrapper_1.length; _i++) {\n                var wrap = appointmentWrapper_1[_i];\n                remove(wrap);\n            }\n        }\n        this.removeHeightProperty(cls.CONTENT_TABLE_CLASS);\n        if (!this.element.querySelector('.' + cls.WORK_CELLS_CLASS)) {\n            return;\n        }\n        if (this.parent.currentView === 'Month') {\n            var wrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            var cellTd = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n            cellTd.appendChild(wrapper);\n            this.monthHeaderHeight = wrapper.offsetTop - cellTd.offsetTop;\n            cellTd.removeChild(wrapper);\n        }\n        this.eventHeight = util.getElementHeightFromClass(this.element, cls.APPOINTMENT_CLASS);\n        var scrollTop = conWrap.scrollTop;\n        if (this.parent.rowAutoHeight && this.parent.virtualScrollModule && !isNullOrUndefined(this.parent.currentAction)) {\n            conWrap.scrollTop = conWrap.scrollTop - 1;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.renderResourceEvents();\n            if (this.parent.virtualScrollModule) {\n                this.parent.virtualScrollModule.updateFocusedWorkCell();\n            }\n        }\n        else {\n            this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays);\n        }\n        if (this.parent.rowAutoHeight) {\n            this.updateBlockElements();\n            var data = {\n                cssProperties: this.parent.getCssProperties(),\n                module: this.parent.getModuleName(),\n                isPreventScrollUpdate: true,\n                scrollPosition: { left: this.parent.uiStateValues.left, top: this.parent.uiStateValues.top }\n            };\n            if (this.parent.virtualScrollModule) {\n                if (this.parent.currentAction) {\n                    conWrap.scrollTop = scrollTop;\n                    this.parent.currentAction = null;\n                }\n                else {\n                    this.parent.virtualScrollModule.updateVirtualScrollHeight();\n                }\n            }\n            if (!this.parent.enablePersistence) {\n                this.parent.notify(events.contentReady, {});\n            }\n            this.parent.notify(events.scrollUiUpdate, data);\n            if (this.parent.currentView === 'Month' && this.parent.showWeekNumber) {\n                var totalCells_1 = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n                var weekNumberCells = [].slice.call(this.parent.element.querySelectorAll('.' + cls.WEEK_NUMBER_CLASS));\n                weekNumberCells.forEach(function (cell, i) {\n                    var height = totalCells_1[i].offsetHeight;\n                    setStyleAttribute(cell, { 'height': height + 'px' });\n                });\n                this.parent.element.querySelector('.' + cls.WEEK_NUMBER_WRAPPER_CLASS).scrollTop =\n                    this.parent.element.querySelector('.' + cls.CONTENT_WRAP_CLASS).scrollTop;\n            }\n        }\n        this.parent.renderTemplates();\n    };\n    MonthEvent.prototype.renderEventsHandler = function (dateRender, workDays, resData) {\n        this.renderedEvents = [];\n        var eventsList;\n        var blockList;\n        var resIndex = 0;\n        if (resData) {\n            resIndex = resData.groupIndex;\n            this.cssClass = resData.cssClass;\n            this.groupOrder = resData.groupOrder;\n            eventsList = this.parent.eventBase.filterEventsByResource(resData, this.parent.eventsProcessed);\n            blockList = this.parent.eventBase.filterEventsByResource(resData, this.parent.blockProcessed);\n            this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS + '[data-group-index=\"' + resIndex + '\"]'));\n        }\n        else {\n            eventsList = this.parent.eventsProcessed;\n            blockList = this.parent.blockProcessed;\n            this.workCells = [].slice.call(this.element.querySelectorAll('.' + cls.WORK_CELLS_CLASS));\n        }\n        this.sortByDateTime(eventsList);\n        this.sortByDateTime(blockList);\n        if (this.parent.currentView === 'Month' && this.parent.rowAutoHeight && this.parent.activeViewOptions.group.resources.length === 0) {\n            var totalCells = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n            var height_1 = this.parent.height === 'auto' ? (this.parent.element.querySelector('.e-content-wrap').clientHeight +\n                this.parent.element.querySelector('.e-date-header-wrap').clientHeight) / totalCells.length\n                : this.parent.element.querySelector('.e-schedule-table').clientHeight / totalCells.length;\n            totalCells.forEach(function (cell) {\n                setStyleAttribute(cell, { 'height': height_1 + 'px' });\n            });\n        }\n        var cellDetail = this.workCells[this.parent.activeView.isTimelineView() ?\n            0 : this.workCells.length - 1].getBoundingClientRect();\n        this.cellWidth = cellDetail.width;\n        this.cellHeight = cellDetail.height;\n        this.dateRender = dateRender;\n        var filteredDates = this.getRenderedDates(dateRender);\n        this.getSlotDates(workDays || this.parent.activeViewOptions.workDays);\n        this.processBlockEvents(blockList, resIndex, resData);\n        var events = [];\n        for (var _i = 0, eventsList_1 = eventsList; _i < eventsList_1.length; _i++) {\n            var event_1 = eventsList_1[_i];\n            if (this.parent.resourceBase && !resData) {\n                this.cssClass = this.parent.resourceBase.getCssClass(event_1);\n            }\n            events = events.concat(this.splitEvent(event_1, filteredDates || this.dateRender));\n        }\n        for (var level = 0; level < this.slots.length; level++) {\n            this.renderedEvents = [];\n            var slot = this.slots[level];\n            var endDate = util.addDays(new Date(slot[slot.length - 1]), 1);\n            var spannedEvents = this.filterEvents(new Date(slot[0]), endDate, events);\n            for (var _a = 0, spannedEvents_1 = spannedEvents; _a < spannedEvents_1.length; _a++) {\n                var event_2 = spannedEvents_1[_a];\n                if (this.maxHeight) {\n                    var sDate = this.parent.currentView === 'Month' ? event_2[this.fields.startTime] :\n                        this.getStartTime(event_2, event_2.data);\n                    if (this.getIndex(sDate) > 0) {\n                        continue;\n                    }\n                }\n                this.updateIndicatorIcon(event_2);\n                this.renderEvents(event_2, resIndex, eventsList);\n            }\n        }\n        this.cssClass = null;\n        this.groupOrder = null;\n    };\n    MonthEvent.prototype.processBlockEvents = function (blockEvents, resIndex, resData) {\n        for (var _i = 0, blockEvents_1 = blockEvents; _i < blockEvents_1.length; _i++) {\n            var event_3 = blockEvents_1[_i];\n            if (this.parent.resourceBase && !resData) {\n                this.cssClass = this.parent.resourceBase.getCssClass(event_3);\n            }\n            var blockSpannedList = [];\n            if (this.renderType === 'day' && !event_3[this.fields.isAllDay]) {\n                var temp = extend({}, event_3, null, true);\n                var isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n                temp.isBlockIcon = isSameDate;\n                if (!isSameDate && util.getDateInMs(temp[this.fields.startTime]) > 0) {\n                    var e = extend({}, event_3, null, true);\n                    e[this.fields.endTime] = util.addDays(util.resetTime(new Date(event_3[this.fields.startTime] + '')), 1);\n                    e.isBlockIcon = true;\n                    temp[this.fields.startTime] = e[this.fields.endTime];\n                    blockSpannedList.push(e);\n                }\n                isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n                if (!isSameDate && util.getDateInMs(temp[this.fields.endTime]) > 0) {\n                    var e = extend({}, event_3, null, true);\n                    e[this.fields.startTime] = util.resetTime(new Date(event_3[this.fields.endTime] + ''));\n                    e.isBlockIcon = true;\n                    blockSpannedList.push(e);\n                    temp[this.fields.endTime] = e[this.fields.startTime];\n                }\n                blockSpannedList.push(temp);\n            }\n            else {\n                blockSpannedList.push(event_3);\n            }\n            for (var _a = 0, blockSpannedList_1 = blockSpannedList; _a < blockSpannedList_1.length; _a++) {\n                var blockEvent = blockSpannedList_1[_a];\n                var spannedEvents = this.splitEvent(blockEvent, this.dateRender);\n                for (var _b = 0, spannedEvents_2 = spannedEvents; _b < spannedEvents_2.length; _b++) {\n                    var event_4 = spannedEvents_2[_b];\n                    this.renderBlockEvents(event_4, resIndex, !!blockEvent.isBlockIcon);\n                }\n            }\n        }\n    };\n    MonthEvent.prototype.isSameDate = function (start, end) {\n        return new Date(+start).setHours(0, 0, 0, 0) === new Date(+end).setHours(0, 0, 0, 0);\n    };\n    MonthEvent.prototype.renderBlockEvents = function (event, resIndex, isIcon) {\n        var eventData = event.data;\n        var startTime = this.getStartTime(event, eventData);\n        var endTime = this.getEndTime(event, eventData);\n        var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(new Date(startTime.getTime())));\n        if (day < 0 || startTime > endTime) {\n            return;\n        }\n        var cellTd = this.getCellTd(day);\n        var position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], day);\n        if (!isIcon) {\n            var diffInDays = eventData.count;\n            var appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n            appWidth = (appWidth <= 0) ? this.cellWidth : appWidth;\n            var appLeft = (this.parent.enableRtl) ? 0 : position;\n            var appRight = (this.parent.enableRtl) ? position : 0;\n            var appHeight = this.cellHeight - this.monthHeaderHeight;\n            var appTop = this.getRowTop(resIndex);\n            var blockElement = this.createBlockAppointmentElement(event, resIndex);\n            setStyleAttribute(blockElement, {\n                'width': appWidth + 'px', 'height': appHeight + 'px', 'left': appLeft + 'px',\n                'right': appRight + 'px', 'top': appTop + 'px'\n            });\n            this.renderEventElement(event, blockElement, cellTd);\n        }\n        else {\n            this.renderBlockIndicator(cellTd, position, resIndex);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    MonthEvent.prototype.renderBlockIndicator = function (cellTd, position, resIndex) {\n        var blockIndicator = createElement('div', { className: 'e-icons ' + cls.BLOCK_INDICATOR_CLASS });\n        if (isNullOrUndefined(cellTd.querySelector('.' + cls.BLOCK_INDICATOR_CLASS))) {\n            cellTd.appendChild(blockIndicator);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    MonthEvent.prototype.getStartTime = function (event, eventData) {\n        return event[this.fields.startTime];\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    MonthEvent.prototype.getEndTime = function (event, eventData) {\n        return event[this.fields.endTime];\n    };\n    MonthEvent.prototype.getCellTd = function (day) {\n        return this.workCells[day];\n    };\n    MonthEvent.prototype.getEventWidth = function (startDate, endDate, isAllDay, count) {\n        return count * this.cellWidth - 1;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    MonthEvent.prototype.getPosition = function (startTime, endTime, isAllDay, day) {\n        return 0;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    MonthEvent.prototype.getRowTop = function (resIndex) {\n        return 0;\n    };\n    MonthEvent.prototype.updateIndicatorIcon = function (event) {\n        if (this.parent.currentView.indexOf('Timeline') === -1 || this.parent.currentView === 'TimelineMonth'\n            || event[this.fields.isAllDay]) {\n            return;\n        }\n        var cloneData = event.data;\n        var start = this.parent.activeView.getStartHour();\n        var end = this.parent.activeView.getEndHour();\n        var startHour = util.getStartEndHours(event[this.fields.startTime], start, end);\n        var endHour = util.getStartEndHours(event[this.fields.endTime], start, end);\n        var actualStartTime = cloneData[this.fields.startTime];\n        var actualEndTime = cloneData[this.fields.endTime];\n        cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() < startHour.startHour.getTime();\n        cloneData.isRight = cloneData.isRight || actualEndTime.getTime() > endHour.endHour.getTime();\n        if (util.resetTime(actualStartTime).getTime() !== util.resetTime(actualEndTime).getTime()) {\n            var actualStartHour = startHour.startHour;\n            var actualEndHour = endHour.endHour;\n            var startTime = new Date(util.resetTime(actualStartTime));\n            startTime.setHours(actualEndHour.getHours(), actualEndHour.getMinutes(), actualEndHour.getSeconds());\n            cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() >= (actualStartHour.getDate() === startHour.endHour.getDate() ?\n                startTime.getTime() : util.addDays(startTime, 1).getTime());\n            if (actualEndTime.getTime() !== util.resetTime(actualEndTime).getTime()) {\n                var endTime = new Date(util.resetTime(actualEndTime));\n                cloneData.isRight = cloneData.isRight || actualEndTime.getTime() <=\n                    endTime.setHours(actualStartHour.getHours(), actualStartHour.getMinutes(), actualStartHour.getSeconds());\n            }\n        }\n    };\n    MonthEvent.prototype.renderResourceEvents = function () {\n        var resources = this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.resourceBase.lastResourceLevel;\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n            for (var i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                var sourceRes = this.parent.crudModule.crudObj.sourceEvent[i];\n                this.renderEventsHandler(sourceRes.renderDates, sourceRes.workDays, sourceRes);\n                if (this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                    this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n                    var target = this.parent.crudModule.crudObj.targetEvent[i];\n                    this.renderEventsHandler(target.renderDates, target.workDays, target);\n                }\n            }\n            this.parent.crudModule.crudObj.isCrudAction = false;\n        }\n        else {\n            for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n                var slotData = resources_1[_i];\n                this.renderEventsHandler(slotData.renderDates, slotData.workDays, slotData);\n            }\n        }\n    };\n    MonthEvent.prototype.getSlotDates = function (workDays) {\n        this.slots = [];\n        var dates = this.dateRender.map(function (date) { return +date; });\n        var noOfDays = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : workDays.length;\n        while (dates.length > 0) {\n            this.slots.push(dates.splice(0, noOfDays));\n        }\n    };\n    MonthEvent.prototype.createAppointmentElement = function (record, resIndex, isCloneElement) {\n        if (isCloneElement === void 0) { isCloneElement = false; }\n        var eventSubject = (record[this.fields.subject] || this.parent.eventSettings.fields.subject.default ||\n            this.parent.localeObj.getConstant('addTitle'));\n        var newRecord = extend({}, record, record.data, true);\n        var attrs = {\n            'data-id': 'Appointment_' + record[this.fields.id],\n            'role': 'button', 'tabindex': '0',\n            'aria-readonly': this.parent.eventBase.getReadonlyAttribute(record), 'aria-selected': 'false', 'aria-grabbed': 'true',\n            'aria-label': this.parent.getAnnouncementString(newRecord, eventSubject)\n        };\n        if (!isCloneElement) {\n            attrs['data-guid'] = record.Guid;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            attrs['data-group-index'] = resIndex.toString();\n        }\n        var appointmentWrapper = createElement('div', { className: cls.APPOINTMENT_CLASS, attrs: attrs });\n        if (!isNullOrUndefined(this.cssClass)) {\n            addClass([appointmentWrapper], this.cssClass);\n        }\n        if (record[this.fields.isReadonly]) {\n            addClass([appointmentWrapper], 'e-read-only');\n        }\n        var appointmentDetails = createElement('div', { className: cls.APPOINTMENT_DETAILS });\n        appointmentWrapper.appendChild(appointmentDetails);\n        var templateElement;\n        var eventData = record.data;\n        var eventObj = this.getEventData(record);\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n            var scheduleId = this.parent.element.id + '_';\n            var viewName = this.parent.activeViewOptions.eventTemplateName;\n            var templateId = scheduleId + viewName + 'eventTemplate';\n            var eventTemplate = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 ? '_' + resIndex : '');\n            templateElement = this.parent.getAppointmentTemplate()(eventObj, this.parent, eventTemplate, templateId, false);\n        }\n        else {\n            var eventLocation = (record[this.fields.location] || this.parent.eventSettings.fields.location.default || '');\n            var appointmentSubject = createElement('div', {\n                className: cls.SUBJECT_CLASS,\n                innerHTML: (eventSubject + (eventLocation ? ';&nbsp' + eventLocation : ''))\n            });\n            var appointmentStartTime = createElement('div', {\n                className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventData[this.fields.startTime])\n            });\n            var appointmentEndTime = createElement('div', {\n                className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventData[this.fields.endTime])\n            });\n            if (this.parent.currentView === 'Month') {\n                if (record[this.fields.isAllDay]) {\n                    templateElement = [appointmentSubject];\n                    addClass([appointmentSubject], 'e-text-center');\n                }\n                else if (eventData.count <= 1 && !eventData.isLeft && !eventData.isRight) {\n                    templateElement = [appointmentStartTime, appointmentSubject];\n                }\n                else {\n                    templateElement = [];\n                    addClass([appointmentSubject], 'e-text-center');\n                    if (!eventData.isLeft) {\n                        templateElement.push(appointmentStartTime);\n                    }\n                    templateElement.push(appointmentSubject);\n                    if (!eventData.isRight) {\n                        templateElement.push(appointmentEndTime);\n                    }\n                }\n            }\n            else {\n                var innerElement = void 0;\n                if (record[this.fields.isAllDay]) {\n                    var allDayString = createElement('div', {\n                        className: cls.APPOINTMENT_TIME, innerHTML: this.parent.localeObj.getConstant('allDay')\n                    });\n                    innerElement = [appointmentSubject, allDayString];\n                }\n                else {\n                    var timeString = this.parent.getTimeString(eventData[this.fields.startTime])\n                        + ' - ' + this.parent.getTimeString(eventData[this.fields.endTime]);\n                    var appTime = createElement('div', {\n                        className: cls.APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : ''), innerHTML: timeString\n                    });\n                    var appLocation = createElement('div', { className: cls.LOCATION_CLASS, innerHTML: eventLocation });\n                    innerElement = [appointmentSubject, appTime, appLocation];\n                }\n                var wrap = createElement('div', { className: 'e-inner-wrap' });\n                append(innerElement, wrap);\n                templateElement = [wrap];\n            }\n        }\n        append(templateElement, appointmentDetails);\n        this.appendEventIcons(record, appointmentDetails);\n        this.renderResizeHandler(appointmentWrapper, record.data, record[this.fields.isReadonly]);\n        return appointmentWrapper;\n    };\n    MonthEvent.prototype.appendEventIcons = function (record, appointmentDetails) {\n        var eventData = record.data;\n        if (!isNullOrUndefined(record[this.fields.recurrenceRule]) || !isNullOrUndefined(record[this.fields.recurrenceID])) {\n            var iconClass = (record[this.fields.id] === record[this.fields.recurrenceID]) ?\n                cls.EVENT_RECURRENCE_ICON_CLASS : cls.EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appointmentDetails.appendChild(createElement('div', {\n                className: cls.ICON + ' ' + iconClass + (this.parent.isAdaptive ? ' ' + cls.DISABLE_CLASS : '')\n            }));\n        }\n        if (eventData.isLeft) {\n            var iconLeft = createElement('div', {\n                className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_LEFT_CLASS\n            });\n            prepend([iconLeft], appointmentDetails);\n        }\n        if (eventData.isRight) {\n            var iconRight = createElement('div', {\n                className: cls.EVENT_INDICATOR_CLASS + ' ' + cls.ICON + ' ' + cls.EVENT_ICON_RIGHT_CLASS\n            });\n            append([iconRight], appointmentDetails);\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    MonthEvent.prototype.renderEvents = function (event, resIndex, eventsList) {\n        var startTime = event[this.fields.startTime];\n        var endTime = event[this.fields.endTime];\n        var day = this.parent.getIndexOfDate(this.dateRender, util.resetTime(startTime));\n        if ((day < 0) || (startTime.getTime() < this.parent.minDate.getTime()) || (endTime.getTime() > this.parent.maxDate.getTime())) {\n            return;\n        }\n        var overlapCount = this.getIndex(startTime);\n        event.Index = overlapCount;\n        var diffInDays = event.data.count;\n        if (startTime.getTime() <= endTime.getTime()) {\n            var appWidth = (diffInDays * this.cellWidth) - 5;\n            var cellTd = this.workCells[day];\n            var appTop = (overlapCount * (this.eventHeight + EVENT_GAP));\n            var height = this.monthHeaderHeight + ((overlapCount + 1) * (this.eventHeight + EVENT_GAP)) + this.moreIndicatorHeight;\n            var enableAppRender = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n            if (this.parent.rowAutoHeight || enableAppRender) {\n                this.renderedEvents.push(extend({}, event, null, true));\n                var appointmentElement = void 0;\n                if (this.inlineValue) {\n                    appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n                }\n                else {\n                    appointmentElement = this.createAppointmentElement(event, resIndex);\n                }\n                this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n                this.wireAppointmentEvents(appointmentElement, event);\n                setStyleAttribute(appointmentElement, { 'width': appWidth + 'px', 'top': appTop + 'px' });\n                this.renderEventElement(event, appointmentElement, cellTd);\n                if (this.parent.rowAutoHeight) {\n                    var firstChild = cellTd.parentElement.firstElementChild;\n                    this.updateCellHeight(firstChild, height);\n                }\n            }\n            else {\n                for (var i = 0; i < diffInDays; i++) {\n                    if (this.workCells[day + i]) {\n                        var indicator = this.workCells[day + i].querySelector('.' + cls.MORE_INDICATOR_CLASS);\n                        if (indicator) {\n                            var count = parseInt(indicator.getAttribute('data-count'), 10) + 1;\n                            indicator.setAttribute('data-count', count.toString());\n                            indicator.innerHTML = this.getMoreIndicatorText(count);\n                        }\n                        else {\n                            var startDate = new Date(this.dateRender[day + i].getTime());\n                            var endDate = util.addDays(this.dateRender[day + i], 1);\n                            var groupIndex = this.workCells[day + i].getAttribute('data-group-index');\n                            var moreIndicatorElement = this.getMoreIndicatorElement(1, startDate, endDate);\n                            if (!isNullOrUndefined(groupIndex)) {\n                                moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n                            }\n                            moreIndicatorElement.style.top = (this.cellHeight - this.monthHeaderHeight - this.moreIndicatorHeight) + 'px';\n                            moreIndicatorElement.style.width = this.cellWidth - 2 + 'px';\n                            this.renderElement(this.workCells[day + i], moreIndicatorElement);\n                            EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    MonthEvent.prototype.updateCellHeight = function (cell, height) {\n        if ((height > cell.offsetHeight)) {\n            setStyleAttribute(cell, { 'height': height + 'px' });\n        }\n    };\n    MonthEvent.prototype.updateBlockElements = function () {\n        var blockElement = [].slice.call(this.element.querySelectorAll('.' + cls.BLOCK_APPOINTMENT_CLASS));\n        for (var _i = 0, blockElement_1 = blockElement; _i < blockElement_1.length; _i++) {\n            var element = blockElement_1[_i];\n            var target = closest(element, 'tr');\n            this.monthHeaderHeight = element.offsetParent.offsetTop - target.offsetTop;\n            element.style.height = ((target.offsetHeight - 1) - this.monthHeaderHeight) + 'px';\n            var firstChild = target.firstElementChild;\n            var width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n            element.style.width = (firstChild.offsetWidth * width) + 'px';\n        }\n    };\n    // eslint-disable-next-line max-len\n    MonthEvent.prototype.getFilteredEvents = function (startDate, endDate, groupIndex, eventsList) {\n        var filteredEvents;\n        if (isNullOrUndefined(groupIndex)) {\n            filteredEvents = this.filterEvents(startDate, endDate);\n        }\n        else {\n            var data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n            filteredEvents = this.filterEvents(startDate, endDate, isNullOrUndefined(eventsList) ? undefined : eventsList, data);\n        }\n        return filteredEvents;\n    };\n    MonthEvent.prototype.getOverlapEvents = function (date, appointments) {\n        var appointmentsList = [];\n        var dateTime = util.resetTime(date).getTime();\n        for (var _i = 0, appointments_1 = appointments; _i < appointments_1.length; _i++) {\n            var app = appointments_1[_i];\n            if ((util.resetTime(app[this.fields.startTime]).getTime() <= dateTime) &&\n                (util.resetTime(app[this.fields.endTime]).getTime() >= dateTime)) {\n                appointmentsList.push(app);\n            }\n        }\n        return appointmentsList;\n    };\n    MonthEvent.prototype.getIndex = function (date) {\n        var appIndex = -1;\n        var appointments = this.renderedEvents;\n        if (appointments.length > 0) {\n            var appointmentsList = this.getOverlapEvents(date, appointments);\n            var appLevel = appointmentsList.map(function (obj) { return obj.Index; });\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\n        }\n        return (appIndex === -1) ? 0 : appIndex;\n    };\n    MonthEvent.prototype.moreIndicatorClick = function (event) {\n        var _this = this;\n        var target = closest(event.target, '.' + cls.MORE_INDICATOR_CLASS);\n        var startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n        var endDate = new Date(parseInt(target.getAttribute('data-end-date'), 10));\n        var groupIndex = target.getAttribute('data-group-index');\n        var moreArgs = {\n            cancel: false, event: event, element: target, isPopupOpen: true,\n            startTime: startDate, endTime: endDate, viewName: this.parent.getNavigateView()\n        };\n        if (groupIndex) {\n            moreArgs.groupIndex = parseInt(groupIndex, 10);\n        }\n        this.parent.trigger(events.moreEventsClick, moreArgs, function (clickArgs) {\n            if (!clickArgs.cancel) {\n                if (clickArgs.isPopupOpen) {\n                    var filteredEvents = _this.getFilteredEvents(startDate, endDate, groupIndex);\n                    var moreArgs_1 = { date: startDate, event: filteredEvents, element: event.target };\n                    _this.parent.quickPopup.moreEventClick(moreArgs_1, endDate, groupIndex);\n                }\n                else {\n                    _this.parent.setProperties({ selectedDate: startDate }, true);\n                    _this.parent.changeView(clickArgs.viewName, event);\n                }\n            }\n        });\n    };\n    MonthEvent.prototype.renderEventElement = function (event, appointmentElement, cellTd) {\n        var _this = this;\n        var eventType = appointmentElement.classList.contains(cls.BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n        var isAppointment = appointmentElement.classList.contains(cls.APPOINTMENT_CLASS);\n        var eventObj = this.getEventData(event);\n        var args = { data: eventObj, element: appointmentElement, cancel: false, type: eventType };\n        this.parent.trigger(events.eventRendered, args, function (eventArgs) {\n            if (eventArgs.cancel) {\n                _this.renderedEvents.pop();\n            }\n            else {\n                _this.renderElement(cellTd, appointmentElement, isAppointment);\n            }\n        });\n    };\n    MonthEvent.prototype.getEventData = function (event) {\n        var eventObj = extend({}, event, null, true);\n        eventObj[this.fields.startTime] = event.data[this.fields.startTime];\n        eventObj[this.fields.endTime] = event.data[this.fields.endTime];\n        return eventObj;\n    };\n    MonthEvent.prototype.renderElement = function (cellTd, element, isAppointment) {\n        if (isAppointment === void 0) { isAppointment = false; }\n        if (this.maxOrIndicator && isAppointment) {\n            this.setMaxEventHeight(element, cellTd);\n        }\n        var wrapperEle = cellTd.querySelector('.' + cls.APPOINTMENT_WRAPPER_CLASS);\n        if (wrapperEle) {\n            wrapperEle.appendChild(element);\n        }\n        else {\n            var wrapper = createElement('div', { className: cls.APPOINTMENT_WRAPPER_CLASS });\n            wrapper.appendChild(element);\n            cellTd.appendChild(wrapper);\n        }\n    };\n    MonthEvent.prototype.getMoreIndicatorElement = function (count, startDate, endDate) {\n        var moreIndicatorElement = createElement('div', {\n            className: cls.MORE_INDICATOR_CLASS,\n            innerHTML: this.getMoreIndicatorText(count),\n            attrs: {\n                'tabindex': '0',\n                'data-count': count.toString(),\n                'data-start-date': startDate.getTime().toString(),\n                'data-end-date': endDate.getTime().toString(),\n                'role': 'list'\n            }\n        });\n        return moreIndicatorElement;\n    };\n    MonthEvent.prototype.getMoreIndicatorText = function (count) {\n        return '+' + this.parent.globalize.formatNumber(count) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n    };\n    MonthEvent.prototype.removeHeightProperty = function (selector) {\n        var rows = [].slice.call(this.element.querySelectorAll('.' + selector + ' tbody tr'));\n        for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n            var row = rows_1[_i];\n            row.firstElementChild.style.height = '';\n        }\n    };\n    MonthEvent.prototype.setMaxEventHeight = function (event, cell) {\n        var headerHeight = util.getOuterHeight(cell.querySelector('.' + cls.DATE_HEADER_CLASS));\n        var height = (cell.offsetHeight - headerHeight) - (this.maxHeight ? 0 : this.moreIndicatorHeight);\n        setStyleAttribute(event, { 'height': height + 'px', 'align-items': 'center' });\n    };\n    MonthEvent.prototype.destroy = function () {\n        this.element = null;\n        this.fields = null;\n        this.maxHeight = null;\n        this.withIndicator = null;\n        this.maxOrIndicator = null;\n        this.moreIndicatorHeight = null;\n        this.removeEventListener();\n        _super.prototype.destroy.call(this);\n    };\n    return MonthEvent;\n}(EventBase));\nexport { MonthEvent };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}